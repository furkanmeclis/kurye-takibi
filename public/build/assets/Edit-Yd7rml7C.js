import{r as c,L as I,R as H,j as e,Y as L,c as s,B as E}from"./app-CbKQlW76.js";import{P as $,M as T}from"./PageContainer-DSGVDqa6.js";import{c as V,a as G,b as m,d as M,u as P,T as Z,I as v}from"./toast.esm-CNW18j1h.js";import{I as U}from"./inputmask.esm-BmHUkyvb.js";import{I as S}from"./inputswitch.esm-BfKpc3Hs.js";import{c as Y,u as J}from"./couriers-BFRc8dnL.js";import{B as Q}from"./blockui.esm-BeJDGdGV.js";import"./PersonalInformation-B8SBmz56.js";import"./message.esm-wxyP2Vmm.js";import"./index.esm-Ddt82mjx.js";import"./PersonalInformation-BcPfBcsH.js";import"./styleclass.esm-CcXE0EGZ.js";const ce=({auth:B,csrfToken:g,courierId:w=0})=>{const{setBreadcrumbs:F}=c.useContext(I);c.useEffect(()=>{F(t=>[...t,{labels:["İşletmeler","Düzenle"],to:window.location.href}])},[]);const[l,O]=c.useState({id:"",name:"",email:"",phone:"",password_change:!1,password:"",password_confirmation:"",account_verification:!1,verified_at:""}),u=H.useRef(null),[p,b]=c.useState(!0),[_,D]=c.useState(!1),K=V().shape({id:G().required("Kurye ID bilgisi bulunamadı"),email:m().email("Geçerli bir email adresi giriniz").required("Email adresinizi giriniz"),name:m().required("Ad soyad giriniz").min(3,"Ad Soyad en az 3 karakter olmalıdır"),phone:m().required("Telefon numarası giriniz").matches(/^\(\d{3}\)-\d{3}-\d{4}$/,"Geçerli bir telefon numarası giriniz"),password:m().when("password_change",{is:!0,then:()=>m().required("Şifre giriniz").min(6,"Şifre en az 6 karakter olmalıdır").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,}$/,"Şifreniz en az bir büyük harf, bir küçük harf ve bir rakam içermelidir"),otherwise:()=>m().notRequired()}),password_confirmation:m().when("password_change",{is:!0,then:()=>m().required("Şifreyi tekrar giriniz").oneOf([M("password"),""],"Şifreler uyuşmuyor"),otherwise:()=>m().notRequired()})}),[y,N]=c.useState(!1),k=P({initialValues:l,validationSchema:K,validateOnChange:_,validateOnBlur:_,enableReinitialize:!0,onSubmit:t=>{b(!0);let o={name:t.name,email:t.email,phone:t.phone,password:t.password,password_confirmation:t.password_confirmation,account_verification:t.account_verification?1:0};t.password_change===!0&&(o={...o,password_change:1}),J(w,o,g).then(a=>{var h,x;if(a.status){(h=u.current)==null||h.show({severity:"success",summary:"Başarılı",detail:a.message});let d={id:a.courier.id,name:a.courier.name,email:a.courier.email,phone:a.courier.phone,password_change:!1,password:"",password_confirmation:"",account_verification:a.courier.verified===1,verified_at:a.courier.verified_at===null?!1:new Date(a.courier.verified_at).toLocaleString()};C({values:d})}else{let d={};a!=null&&a.emailExists&&(a==null?void 0:a.emailExists)===!0&&(d={...d,email:"Bu email adresi zaten kullanılmakta"}),a!=null&&a.phoneExists&&(a==null?void 0:a.phoneExists)===!0&&(d={...d,phone:"Bu telefon numarası zaten kullanılmakta"}),j(d),(x=u.current)==null||x.show({severity:"error",summary:"Hata",detail:a.message})}}).catch(()=>{var a;(a=u.current)==null||a.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu lütfen tekrar deneyiniz."})}).finally(()=>{b(!1)})}});let{values:n,setFieldValue:z,resetForm:C,submitCount:r,setErrors:j,handleChange:f,handleSubmit:A,isValid:q,dirty:R}=k,i=k.errors;return c.useEffect(()=>{w!==void 0&&Y(w,g).then(t=>{var h;let{status:o}=t,a=t.courier;if(o){let x={id:a.id,name:a.name,email:a.email,phone:a.phone,password_change:!1,password:"",password_confirmation:"",account_verification:a.verified===1,verified_at:a.verified_at===null?!1:new Date(a.verified_at).toLocaleString()};O(x),C({values:x,errors:{}})}else N(!0),j({id:"Kurye bilgileri alınamadı"}),(h=u.current)==null||h.show({severity:"error",summary:"Hata",detail:"Kurye bilgileri alınamadı"})}).catch(t=>{var o;console.error(t),N(!0),j({id:"Kurye bilgileri alınamadı"}),(o=u.current)==null||o.show({severity:"error",summary:"Hata",detail:"Bir Hata Oluştu Kurye Bilgileri Alınamadı"})}).finally(()=>{b(!1)})},[g,w]),c.useEffect(()=>{r>0&&D(!0)},[r]),e.jsx($,{auth:B,csrfToken:g,children:e.jsxs(T,{children:[e.jsx(L,{title:(l==null?void 0:l.name)!==""?"'"+(l==null?void 0:l.name)+"' Adlı Kuryeyi Düzenle":""}),e.jsx(Z,{ref:u}),e.jsxs("div",{className:"card",children:[e.jsxs("span",{className:"text-900 text-xl font-bold mb-4 block",children:[(l==null?void 0:l.name)!==""?"'"+(l==null?void 0:l.name)+"' Adlı Kuryeyi Düzenle":""," "]}),e.jsxs("div",{className:"grid",children:[e.jsxs("div",{className:"col-12 lg:col-2",children:[e.jsx("div",{className:"text-900 font-medium text-xl mb-3",children:"Kurye Bilgileri"}),e.jsxs("p",{className:"m-0 p-0 text-600 line-height-3 mr-3",children:["Düzeltmek istediğiniz kuryenin bilgilerini aşağıdaki form aracılığıyla düzenleyebilirsiniz.",i&&Object.keys(i).length>0&&e.jsx(e.Fragment,{children:e.jsx("ul",{className:"mt-3",children:Object.keys(i).map((t,o)=>e.jsx("li",{className:"text-red-500 text-sm",children:i[t]},o))})})]})]}),e.jsx("div",{className:"col-12 lg:col-10",children:e.jsx(Q,{blocked:y,template:e.jsx("i",{className:"pi pi-exclamation-circle text-red-400",style:{fontSize:"3rem"}}),containerClassName:s("",{"p-3":y,"p-0":!y}),children:e.jsxs("form",{onSubmit:A,className:"grid formgrid p-fluid",children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"name",className:s("font-medium text-900",{"text-red-500":!!i.name,"text-green-500":!i.name&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!i.name,"pi-check-circle text-green-500 text-sm":!i.name&&r>0})})," Ad Soyad"]}),e.jsx(v,{id:"name",type:"text",autoComplete:"off",name:"name",tooltip:i.name,tooltipOptions:{position:"top"},disabled:p,onChange:f,value:n.name,className:s("w-full",{"p-invalid":!!i.name})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"email",className:s("font-medium text-900",{"text-red-500":!!i.email,"text-green-500":!i.email&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!i.email,"pi-check-circle text-green-500 text-sm":!i.email&&r>0})})," Email Adresi"]}),e.jsx(v,{id:"email",type:"email",autoComplete:"off",name:"email",tooltip:i==null?void 0:i.email,tooltipOptions:{position:"top"},disabled:p,onChange:f,value:n.email,className:s("w-full",{"p-invalid":!!i.email})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"phone",className:s("font-medium text-900",{"text-red-500":!!i.phone,"text-green-500":!i.phone&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!i.phone,"pi-check-circle text-green-500 text-sm":!i.phone&&r>0})})," Telefon Numarası"]}),e.jsx(U,{autoComplete:"off",name:"phone",tooltip:i==null?void 0:i.phone,tooltipOptions:{position:"top",event:"focus",className:"text-red-500"},disabled:p,onChange:f,value:n.phone,mask:"(999)-999-9999",className:s("w-full",{"p-invalid":!!i.phone})})]}),e.jsxs("div",{className:"field mb-4 col-12 p-input-icon-right",children:[e.jsx("label",{htmlFor:"password_change",className:s("font-medium text-900 cursor-pointer select-none"),children:"Şifre Değişikliği"}),e.jsx("br",{}),e.jsx(S,{inputId:"password_change",checked:n.password_change,onChange:t=>z("password_change",t.value??!1)})]}),n.password_change&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"password",className:s("font-medium text-900",{"text-red-500":!!i.password,"text-green-500":!i.password&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!i.password,"pi-check-circle text-green-500 text-sm":!i.password&&r>0})})," Şifre"]}),e.jsx(v,{id:"password",type:"password",autoComplete:"off",name:"password",tooltip:i==null?void 0:i.password,tooltipOptions:{position:"top"},disabled:p,onChange:f,value:n.password,className:s("w-full",{"p-invalid":!!i.password})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"password_confirmation",className:s("font-medium text-900",{"text-red-500":!!i.password_confirmation,"text-green-500":!i.password_confirmation&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!i.password_confirmation,"pi-check-circle text-green-500 text-sm":!i.password_confirmation&&r>0})})," Şifre Tekrarı"]}),e.jsx(v,{id:"password_confirmation",type:"password",autoComplete:"off",name:"password_confirmation",tooltip:i==null?void 0:i.password_confirmation,tooltipOptions:{position:"top"},disabled:p,onChange:f,value:n.password_confirmation,className:s("w-full",{"p-invalid":!!i.password_confirmation})})]})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"account_verification",className:s("font-medium text-900 cursor-pointer select-none"),children:["Hesap Onayı ",n.account_verification&&n.verified_at!==!1&&e.jsxs("span",{className:"text-green-500",children:["Onaylandı : ",n.verified_at]})]}),e.jsx("br",{}),e.jsx(S,{inputId:"account_verification",checked:n.account_verification,onChange:t=>z("account_verification",t.value??!1)})]}),e.jsxs("div",{className:"col-12",children:[e.jsx(E,{label:"Geri",icon:"pi pi-arrow-left",type:"button",severity:"secondary",size:"small",onClick:()=>{window.history.back()},className:"w-auto mt-3 mr-2"}),e.jsx(E,{label:"Kuryeyi Kaydet",disabled:!q||!R,loading:p,size:"small",type:"submit",className:"w-auto mt-3"})]})]})})})]})]})]})})};export{ce as default};
