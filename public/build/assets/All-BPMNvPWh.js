import{r as v,u as H,j as t,c as R,B as d,y as A,R as w,Y as G,a as x}from"./app-U6D2PzfD.js";import{P as D,M as E}from"./PageContainer-BdNeVY65.js";import{T as F}from"./toast.esm-DmrTv30h.js";import{g as V,d as $,a as K,m as Y,b as I}from"./businesses-B8cWdWWF.js";import{O as q,C as J,D as Q,a as U,T as W}from"./checkbox.esm-BvO80h6o.js";import{M as N}from"./message.esm-B7m32CDq.js";import{T as X}from"./tristatecheckbox.esm-DNmT7tys.js";import"./PersonalInformation-yfbgH-Hy.js";import"./inputmask.esm-DkTyA19i.js";import"./PersonalInformation-ED77fZOX.js";import"./styleclass.esm-nfnQ_JLj.js";import"./index.esm-H1sz6LYB.js";const de=({auth:P,csrfToken:f,flash:u})=>{const[b,r]=v.useState(!0),[m,g]=v.useState([]),[p,y]=v.useState([]),[c,S]=H(["name","email","phone","created_at","actions"],"adminBusinessesApprovedColumns"),[j,C]=v.useState(null),k=()=>{r(!0),V("all",f).then(e=>{e.status?(g(e.businesses.map(i=>({...i,verified:i.verified===1}))),r(!1),C(null)):(C(e.message),r(!1))}).catch(e=>{C(e.message),r(!1)}).finally(()=>r(!1))};v.useEffect(()=>{var e;k(),u!=null&&u.message&&((e=s.current)==null||e.show({severity:(u==null?void 0:u.type)??"info",summary:u.title,detail:u.message??""}))},[]);const O=(e,i)=>{x({target:e.currentTarget,message:"İşletmeyi silmek istediğinize emin misiniz?",acceptLabel:"Sil",acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){r(!0),$(i,f).then(({status:l,message:a})=>{var n,o;l?(g(m.filter(h=>h.id!==i)),y([]),(n=s.current)==null||n.show({severity:"success",summary:"Başarılı",detail:a})):(o=s.current)==null||o.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=s.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>r(!1))}})},L=(e,i)=>{x({target:e.currentTarget,message:"Seçilen İşletmeler silinecektir. Silmek istediğinize emin misiniz?",acceptLabel:`Sil (${i.length} İşletme)`,acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){r(!0),Y(i,f).then(({status:l,message:a})=>{var n,o;l?(g(m.filter(h=>!i.includes(h.id))),y([]),(n=s.current)==null||n.show({severity:"success",summary:"Başarılı",detail:a})):(o=s.current)==null||o.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=s.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>r(!1))}})},B=(e,i)=>{x({target:e.currentTarget,message:"İşletme Hesabı Onaylanacaktır. Onaylamak istediğinize emin misiniz?",acceptLabel:"Onayla",acceptClassName:"p-button-success",rejectLabel:"Vazgeç",accept(){r(!0),K(i,f).then(({status:l,message:a})=>{var n,o;l?(g(m.filter(h=>h.id!==i)),y([]),(n=s.current)==null||n.show({severity:"success",summary:"Başarılı",detail:a})):(o=s.current)==null||o.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=s.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>r(!1))}})},M=(e,i)=>{x({target:e.currentTarget,message:"Seçilen işletmelerin hesapları onaylanacaktır. Onaylamak istediğinize emin misiniz?",acceptLabel:`Onayla (${i.length} İşletme)`,acceptClassName:"p-button-success",rejectLabel:"Vazgeç",accept(){r(!0),I(i,f).then(({status:l,message:a})=>{var n,o;l?(g(m.filter(h=>!i.includes(h.id))),y([]),(n=s.current)==null||n.show({severity:"success",summary:"Başarılı",detail:a})):(o=s.current)==null||o.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=s.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>r(!1))}})};let z=[{selectionMode:"multiple",headerStyle:{width:"3rem"},header:""},{field:"name",header:"Adı Soyadı(İşletme Sahibi)",hidden:!c.includes("name"),sortable:!0,filter:!0,filterPlaceholder:"Ad'a Göre"},{field:"email",header:"Email Adresi",hidden:!c.includes("email"),sortable:!0,filter:!0,filterPlaceholder:"Email'e Göre"},{field:"phone",header:"Telefon Numarası",hidden:!c.includes("phone"),sortable:!0,filter:!0,filterPlaceholder:"Telefon Numarası'na Göre"},{field:"verified",header:"Onay Durumu",hidden:!c.includes("verified"),sortable:!0,filter:!0,dataType:"boolean",filterElement:e=>t.jsx(X,{value:e.value,onChange:i=>e.filterApplyCallback(i.value)}),body:e=>t.jsx("i",{className:R("pi",{"pi-check-circle text-green-400":e.verified,"pi-times-circle text-red-400":!e.verified})})},{field:"verified_at",header:"Onay Tarihi",hidden:!c.includes("verified_at"),sortable:!0,filter:!0,filterPlaceholder:"Onay Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:e.verified_at===null?t.jsx("i",{className:"pi pi-times-circle text-red-400"}):new Date(e.verified_at).toLocaleString()})},{field:"created_at",header:"Kayıt Tarihi",hidden:!c.includes("created_at"),sortable:!0,filter:!0,filterPlaceholder:"Kayıt Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:new Date(e.created_at).toLocaleString()})},{field:"updated_at",header:"Güncelleme Tarihi",hidden:!c.includes("updated_at"),sortable:!0,filter:!0,filterPlaceholder:"Güncellenme Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:new Date(e.updated_at).toLocaleString()})},{field:"actions",header:"İşlemler",hidden:!c.includes("actions"),body:e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(d,{visible:!e.verified,size:"small",icon:"pi pi-check-circle",severity:"success",tooltip:"Onayla",tooltipOptions:{position:"top"},onClick:i=>{B(i,e.id)}}),t.jsx(d,{size:"small",icon:"pi pi-pencil",severity:"warning",tooltip:"Düzenle",tooltipOptions:{position:"top"},onClick:()=>{A.visit(route("admin.businesses.edit",{id:e.id}))}}),t.jsx(d,{size:"small",icon:"pi pi-trash",severity:"danger",tooltip:"Sil",tooltipOptions:{position:"top"},onClick:i=>{O(i,e.id)}})]})}];const T=w.useRef(null),_=()=>t.jsx(t.Fragment,{children:t.jsx(W,{start:p.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(d,{size:"small",icon:"pi pi-check-circle",className:"mr-2",tooltip:"Toplu Onay Yapmanızı Sağlar",tooltipOptions:{position:"top"},visible:p.map(e=>e.verified?null:e.id).filter(e=>e!==null).length>0,label:"Onayla ("+p.map(e=>e.verified?null:e.id).filter(e=>e!==null).length+")",severity:"success",onClick:e=>{M(e,p.map(i=>i.verified?null:i.id).filter(i=>i!==null))}}),t.jsx(d,{size:"small",icon:"pi pi-trash",className:"mr-2",tooltip:"Seçilen İşletmeleri Silmenizi Sağlar",tooltipOptions:{position:"top"},label:"Sil ("+p.length+")",severity:"danger",onClick:e=>{L(e,p.map(i=>i.id))}}),t.jsx(d,{size:"small",icon:"pi pi-filter-slash",label:"Seçimi Temizle",severity:"warning",onClick:()=>y([])})]}),end:t.jsxs(t.Fragment,{children:[t.jsx(d,{size:"small",icon:"pi pi-sync",severity:"help",className:"mr-2",tooltip:"Verileri Yenile",tooltipOptions:{position:"top"},onClick:()=>{k()}}),t.jsx(d,{size:"small",icon:"pi pi-bars",onClick:e=>{var i;(i=T.current)==null||i.toggle(e)}})]})})}),s=w.useRef(null);return t.jsx(D,{auth:P,csrfToken:f,children:t.jsxs(E,{children:[t.jsx(G,{title:"Tüm İşletmeler"}),t.jsx(F,{ref:s}),t.jsxs(q,{ref:T,showCloseIcon:!0,style:{width:"300px"},children:[t.jsx("div",{className:"flex align-items-center justify-content-start mb-3",children:t.jsxs("span",{className:"text-900 text-lg font-bold",children:["Sütunlar (",c.length,")"]})}),t.jsx("div",{className:"flex flex-column justify-content-center gap-2",children:z.map((e,i)=>{if(e.selectionMode==="multiple")return null;let l=e.header,a=e.field;return t.jsxs("div",{className:"flex align-items-center",children:[t.jsx(J,{inputId:`column${i}`,checked:c.includes(a),onChange:n=>{n.checked?S([...c,a]):S(c.filter(o=>o!==a))}}),t.jsx("label",{htmlFor:`column${i}`,className:"ml-2",children:l})]},i)})})]}),t.jsxs("div",{className:"card",children:[t.jsx("span",{className:"text-900 text-xl font-bold mb-4 block",children:"Tüm İşletmeler"}),j!==null&&t.jsx(N,{className:"w-full",severity:"error",text:j}),!b&&m.length===0&&t.jsx(N,{className:"w-full",severity:"info",text:"İşletme bulunamadı."}),t.jsx(Q,{hidden:!b&&m.length===0||j!==null,loading:b,value:m,removableSort:!0,paginator:!0,filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",header:_,filters:{name:{value:null,matchMode:"contains"},email:{value:null,matchMode:"contains"},phone:{value:null,matchMode:"contains"},created_at:{value:null,matchMode:"contains"},updated_at:{value:null,matchMode:"contains"},verified:{value:null,matchMode:"equals"}},emptyMessage:"İşletme bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",selectionMode:"checkbox",selection:p,onSelectionChange:e=>y(e.value),children:z.map((e,i)=>t.jsx(U,{...e},i))})]})]})})};export{de as default};
