import{r as _,L as Z,R as ee,j as e,B,c as l}from"./app-BUYDDfPN.js";import{c as ie,b as d,e as te,u as ae,I as N}from"./inputtext.esm-CXYMOS3i.js";import{I as le}from"./inputmask.esm-BV_Q9Uun.js";import{T as se}from"./toast.esm-CXYhB19S.js";import{c as f,t as k,b as M,S as ne,d as re,M as $,D as O,I as R,e as de}from"./message.esm-J9njUTBM.js";import{c as ce}from"./globalHelper-B-s3UrsJ.js";import"./index.esm-Dp1QBIFe.js";const me=async(w,C)=>{let g=route("business.savePersonalInformation"),v=new Headers;return v.append("X-CSRF-TOKEN",C),v.append("Content-Type","application/json"),await(await fetch(g,{method:"POST",headers:v,body:JSON.stringify(w)})).json()},oe=async w=>{let C=route("business.getPersonalInformation"),g=new Headers;return g.append("X-CSRF-TOKEN",w),g.append("Content-Type","application/json"),await(await fetch(C,{method:"POST",headers:g})).json()},_e=({page:w=!1,profileCompleted:C=!1,profilePage:g=!1,profileApproved:v=!1,csrfToken:F})=>{var A;const{setBreadcrumbs:Y,setLayoutConfig:G}=_.useContext(Z),[H,I]=_.useState(!1),[z,V]=_.useState(v===1),[S,K]=_.useState(0),u=ee.useRef(null),[b,j]=_.useState(!1),[q,X]=_.useState(!1),J=ie().shape({name:d().required("Ad soyad giriniz").min(3,"Ad Soyad en az 3 karakter olmalıdır"),email:d().email("Geçerli bir email adresi giriniz").required("Email adresinizi giriniz"),phone:d().required("Telefon numarası giriniz").matches(/^\(\d{3}\)-\d{3}-\d{4}$/,"Geçerli bir telefon numarası giriniz"),address:d().required("Adresinizi giriniz").min(10,"Adres en az 10 karakter olmalıdır"),city:d().required("Şehir bilgisini seçiniz"),state:d().required("İlçe bilgisini seçiniz"),zip:d().required("Posta kodu giriniz").matches(/^\d{5}$/,"Geçerli bir posta kodu giriniz"),country:d().required("Ülke bilgisini seçiniz"),status:d().nullable(),billing:te().oneOf(["individual","company"]).required("Fatura türünü seçiniz"),latitude:d().required("Konum Bilgisi Gereklidir Lütfen Konum Ekleyiniz").min(3,"Lütfen Konum Ekleyiniz"),identity:d().when("billing",{is:"individual",then:()=>d().required("Kimlik numarası zorunludur").max(11,"Kimlik numarası 11 karakter olmalıdır").min(11,"Kimlik numarası 11 karakter olmalıdır"),otherwise:()=>d().nullable()}),birth_date:d().when("billing",{is:"individual",then:()=>d().required("Doğum tarihi zorunludur"),otherwise:()=>d().nullable()}),tax_name:d().when("billing",{is:"company",then:()=>d().required("Vergi mükellefi adı zorunludur"),otherwise:()=>d().nullable()}),tax_number:d().when("billing",{is:"company",then:()=>d().required("Vergi numarası zorunludur").max(10,"Vergi numarası 10 karakter olmalıdır").min(10,"Vergi numarası 10 karakter olmalıdır"),otherwise:()=>d().nullable()}),tax_address:d().when("billing",{is:"company",then:()=>d().required("Vergi adresi zorunludur").min(10,"Adres en az 10 karakter olmalıdır"),otherwise:()=>d().nullable()}),tax_office:d().when("billing",{is:"company",then:()=>d().required("Vergi dairesi zorunludur"),otherwise:()=>d().nullable()})});let E=f.map(a=>a.il_adi),T=f[0],D=T.ilceler[0],L=k[0],{values:c,setFieldValue:o,resetForm:P,submitCount:s,setErrors:ue,handleChange:p,handleSubmit:Q,errors:i,isValid:U,dirty:W}=ae({initialValues:{name:"",phone:"",email:"",address:"",city:T.il_adi,selectedCity:T,state:D.ilce_adi,selectedState:D,zip:"",country:"turkey",billing:"individual",identity:"",birth_date:new Date(new Date().setFullYear(new Date().getFullYear()-18)),tax_name:"",tax_number:"",tax_address:"",tax_office:L.vergi_dairesi,selectedTaxOffice:L,latitude:"",longitude:""},validationSchema:J,validateOnChange:q,validateOnBlur:q,onSubmit:a=>{let t={};Object.entries(a).forEach(([m,x])=>{if(m==="birth_date"){let r=x;t[m]=`${String(r.getDate()).padStart(2,"0")}.${String(r.getMonth()+1).padStart(2,"0")}.${r.getFullYear()}`}else m!=="selectedCity"&&m!=="selectedState"&&m!=="selectedTaxOffice"&&(t[m]=String(x))}),a.billing==="company"?(t==null||delete t.identity,t==null||delete t.birth_date):a.billing==="individual"&&(t==null||delete t.tax_name,t==null||delete t.tax_number,t==null||delete t.tax_address,t==null||delete t.tax_office),j(!0),me(t,F).then(m=>{var x,r;if(m.status){let n=m.details,y={name:n.name,phone:n.phone,email:n.email,address:n.address,city:n.city,selectedCity:{},state:n.state,selectedState:{},zip:n.zip,country:n.country,billing:n.billing,identity:n.identity||"",birth_date:new Date,tax_name:n.tax_name||"",tax_number:n.tax_number||"",tax_address:n.tax_address||"",tax_office:n.tax_office||"",selectedTaxOffice:{},latitude:n.latitude||"",longitude:n.longitude||""};if(y.selectedCity=f.find(h=>h.il_adi===n.city),y.selectedState=y.selectedCity.ilceler.find(h=>h.ilce_adi===n.state),y.billing==="individual"){let h=n.birth_date.split(".");y.birth_date=new Date(parseInt(h[2]),parseInt(h[1])-1,parseInt(h[0]))}else y.billing==="company"&&(y.selectedTaxOffice=k.find(h=>h.vergi_dairesi===n.tax_office));V(n.approved===1),I(n.completed===1),P({values:y}),(x=u.current)==null||x.show({severity:"success",summary:"Başarılı",detail:m.message})}else(r=u.current)==null||r.show({severity:"error",summary:"Hata",detail:m.message})}).catch(m=>{var x;console.error(m),(x=u.current)==null||x.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu lütfen tekrar deneyiniz."})}).finally(()=>{j(!1)})}});return _.useEffect(()=>{s>0&&X(!0)},[s]),_.useEffect(()=>{j(!0),oe(F).then(({status:a,details:t,courier:m})=>{var x;if(a){let r={name:t.name,phone:t.phone,email:t.email,address:t.address,city:t.city,selectedCity:{},state:t.state,selectedState:{},zip:t.zip,country:"turkey",billing:t.billing,identity:t.identity||"",birth_date:new Date,tax_name:t.tax_name||"",tax_number:t.tax_number||"",tax_address:t.tax_address||"",tax_office:t.tax_office||"",selectedTaxOffice:{},vehicle_type:t.vehicle_type,latitude:t.latitude||"",longitude:t.longitude||""};if(t.city!==null?(r.selectedCity=f.find(n=>n.il_adi===t.city),t.state!==null&&((x=r.selectedCity)==null?void 0:x.ilceler)!==null?r.selectedState=r.selectedCity.ilceler.find(n=>n.ilce_adi===t.state):(r.selectedState=r.selectedCity.ilceler[0],r.state=r.selectedCity.ilceler[0].ilce_adi)):(r.selectedCity=f[0],r.selectedState=f[0].ilceler[0],r.city=f[0].il_adi,r.state=f[0].ilceler[0].ilce_adi),r.billing==="individual")if((t==null?void 0:t.birth_date)!==null){let n=t.birth_date.split(".");r.birth_date=new Date(parseInt(n[2]),parseInt(n[1])-1,parseInt(n[0]))}else r.birth_date=new Date;else r.billing==="company"&&((r==null?void 0:r.tax_office)!==null?r.selectedTaxOffice=k.find(n=>n.vergi_dairesi===t.tax_office):(r.selectedTaxOffice=k[0],r.tax_office=k[0].vergi_dairesi));V((t==null?void 0:t.approved)===1),I((t==null?void 0:t.completed)===1),P({values:r})}}).catch(a=>{var t;console.log(a),(t=u.current)==null||t.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu lütfen tekrar deneyiniz."})}).finally(()=>{j(!1)}),g||(Y([]),G(a=>({...a,menuMode:"overlay"})))},[]),e.jsxs("div",{className:"card",children:[e.jsx(se,{ref:u}),!g&&e.jsx("span",{className:"text-900 text-xl font-bold mb-4 block",children:"Profilinizi Tamamlayın"}),e.jsxs("div",{className:"grid",children:[e.jsxs("div",{className:"col-12 lg:col-2",children:[e.jsx("div",{className:"text-900 font-medium text-xl mb-3",children:"Kişisel Bilgileriniz"}),e.jsxs("p",{className:"m-0 p-0 text-600 line-height-3 mr-3",children:["Sistemdeki bilgilerinizin güncel olması gerekmektedir. Lütfen aşağıdaki alanları doldurunuz.",!v&&"Onay sürecinden sonra üyeliğiniz aktif edilecektir."]}),e.jsx(M,{}),e.jsx(B,{icon:"pi pi-map-marker",severity:i.latitude?"danger":c.latitude!==""?"success":"info",size:"small",label:c.latitude!==""?"Konum Ekli":"Konum Ekle",disabled:c.latitude!=="",onClick:()=>{u!=null&&u.current&&(j(!0),ce(u==null?void 0:u.current).then(a=>{o("latitude",a.latitude),o("longitude",a.longitude)}).catch(()=>{}).finally(()=>j(!1)))}}),(S===1||z)&&e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsxs("div",{className:"field mb-4 w-full",children:[e.jsxs("label",{htmlFor:"billing",className:l("font-medium text-900",{"text-red-500":!!i.billing,"text-green-500":!i.billing&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.billing,"pi-check-circle text-green-500 text-sm":!i.billing&&s>0})})," Faturalandırma Türü"]}),e.jsx(ne,{options:[{name:"Bireysel",value:"individual",icon:"pi pi-user"},{name:"Kurumsal",value:"company",icon:"pi pi-briefcase"}],optionLabel:"name",tooltip:"Bireysel / Kurumsal",tooltipOptions:{position:"top"},className:"w-full",itemTemplate:a=>e.jsx("div",{className:"flex align-items-center",title:a.name,children:e.jsx("i",{className:a.icon+" text-xl"})}),allowEmpty:!1,optionValue:"value",value:c.billing,onChange:a=>{a.value!==null&&o("billing",a.value)}})]})]})]}),e.jsxs("div",{className:"col-12 lg:col-10",children:[!z&&e.jsx(re,{model:[{label:"Giriş"},{label:"Detaylar"}],readOnly:!1,onSelect:a=>K(a.index),activeIndex:S,className:"mb-4"}),S===0&&!z&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:H?!z&&e.jsx($,{className:"w-full",severity:"success",text:"Profil Bilgilerinizi Kaydettiniz Ancak *Yönetici Onayı* Beklemektedir. Değiştirmek istediğiniz bilgileri sonraki ekrandan yönetebilirsiniz."}):e.jsx(e.Fragment,{children:e.jsx($,{className:"w-full",severity:"warn",text:"Profil Bilgilerinizi Sonraki Formdan Ekleyiniz. Onay sürecinden sonra üyeliğiniz aktif edilecektir."})})}),e.jsx("div",{className:"grid",children:e.jsx("div",{className:"col-12 flex justify-content-end mt-4",children:e.jsx(B,{label:"İlerle",size:"small",severity:"success",icon:"pi pi-arrow-right",onClick:()=>{K(1)}})})})]}),(S===1||z)&&e.jsxs("form",{onSubmit:Q,className:"grid formgrid p-fluid",children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"name",className:l("font-medium text-900",{"text-red-500":!!i.name,"text-green-500":!i.name&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.name,"pi-check-circle text-green-500 text-sm":!i.name&&s>0})})," Ad Soyad"]}),e.jsx(N,{id:"name",type:"text",autoComplete:"off",name:"name",tooltip:i.name,tooltipOptions:{position:"top"},readOnly:!0,disabled:!0,onChange:p,value:c.name,className:l("w-full",{"p-invalid":!!i.name})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"email",className:l("font-medium text-900",{"text-red-500":!!i.email,"text-green-500":!i.email&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.email,"pi-check-circle text-green-500 text-sm":!i.email&&s>0})})," Email Adresi"]}),e.jsx(N,{id:"email",type:"email",autoComplete:"off",name:"email",readOnly:!0,tooltip:i==null?void 0:i.email,tooltipOptions:{position:"top"},disabled:!0,onChange:p,value:c.email,className:l("w-full",{"p-invalid":!!i.email})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"phone",className:l("font-medium text-900",{"text-red-500":!!i.phone,"text-green-500":!i.phone&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.phone,"pi-check-circle text-green-500 text-sm":!i.phone&&s>0})})," Telefon Numarası"]}),e.jsx(le,{autoComplete:"off",name:"phone",readOnly:!0,tooltip:i==null?void 0:i.phone,tooltipOptions:{position:"top",event:"focus",className:"text-red-500"},disabled:!0,onChange:p,value:c.phone,mask:"(999)-999-9999",className:l("w-full",{"p-invalid":!!i.phone})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"city",className:l("font-medium text-900",{"text-red-500":!!i.city,"text-green-500":!i.city&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.city,"pi-check-circle text-green-500 text-sm":!i.city&&s>0})})," İl"]}),e.jsx(O,{value:c.selectedCity,onChange:a=>{o("city",a.value.il_adi),o("selectedCity",a.value),o("state",a.value.ilceler[0].ilce_adi),o("selectedState",a.value.ilceler[0])},options:f,optionLabel:"il_adi",inputId:"city",placeholder:"Şehir Seçiniz",className:l("w-full",{"p-invalid":!!i.city}),filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"Şehir Bulunamadı",emptyFilterMessage:"Şehir Bulunamadı",filterBy:"il_adi"})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"state",className:l("font-medium text-900",{"text-red-500":!!i.state,"text-green-500":!i.state&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.state,"pi-check-circle text-green-500 text-sm":!i.state&&s>0})})," İlçe"]}),e.jsx(O,{value:c.selectedState,inputId:"state",disabled:c.selectedCity===null,onChange:a=>{o("state",a.value.ilce_adi),o("selectedState",a.value)},options:(A=c.selectedCity)==null?void 0:A.ilceler,optionLabel:"ilce_adi",placeholder:"İlçe Seçiniz",className:l("w-full",{"p-invalid":!!i.state}),filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"İlçe Bulunamadı",emptyFilterMessage:"İlçe Bulunamadı",filterBy:"ilce_adi"})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"country",className:l("font-medium text-900",{"text-red-500":!!i.country,"text-green-500":!i.country&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.country,"pi-check-circle text-green-500 text-sm":!i.country&&s>0})})," Ülke"]}),e.jsx(O,{value:"turkey",inputId:"country",options:[{label:"Türkiye",value:"turkey"}],optionLabel:"label",placeholder:"Ülke Seçiniz",className:l("w-full",{"p-invalid":!!i.country})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"name",className:l("font-medium text-900",{"text-red-500":!!i.zip,"text-green-500":!i.zip&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.zip,"pi-check-circle text-green-500 text-sm":!i.zip&&s>0})})," Posta Kodu"]}),e.jsx(N,{id:"name",type:"text",autoComplete:"off",name:"zip",tooltip:i.zip,tooltipOptions:{position:"top"},disabled:b,onChange:p,value:c.zip,className:l("w-full",{"p-invalid":!!i.zip})})]}),e.jsxs("div",{className:"field mb-4 col-12  p-input-icon-right",children:[e.jsxs("label",{htmlFor:"address",className:l("font-medium text-900",{"text-red-500":!!i.address,"text-green-500":!i.address&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.address,"pi-check-circle text-green-500 text-sm":!i.address&&s>0})})," Adres"]}),e.jsx(R,{id:"name",autoComplete:"off",name:"address",tooltip:i.address,tooltipOptions:{position:"top"},disabled:b,onChange:p,value:c.address,className:l("w-full",{"p-invalid":!!i.address})})]}),c.billing==="individual"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"identity",className:l("font-medium text-900",{"text-red-500":!!i.identity,"text-green-500":!i.identity&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.identity,"pi-check-circle text-green-500 text-sm":!i.identity&&s>0})})," Kimlik Numarası"]}),e.jsx(N,{id:"identity",autoComplete:"off",name:"identity",tooltip:i.identity,tooltipOptions:{position:"top"},disabled:b,onChange:p,value:c.identity,className:l("w-full",{"p-invalid":!!i.identity})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"birth_date",className:l("font-medium text-900",{"text-red-500":!!i.birth_date,"text-green-500":!i.birth_date&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.birth_date,"pi-check-circle text-green-500 text-sm":!i.birth_date&&s>0})})," Doğum Tarihi (gg.aa.yyyy)"]}),e.jsx(de,{inputId:"birth_date",name:"birth_date",disabled:b,tooltip:(i==null?void 0:i.birth_date)&&String(i==null?void 0:i.birth_date),tooltipOptions:{position:"top"},maxDate:new Date(new Date().setFullYear(new Date().getFullYear()-18)),onChange:a=>{o("birth_date",a.value)},value:c.birth_date,className:l("w-full",{"p-invalid":!!i.birth_date})})]})]}),c.billing==="company"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"tax_name",className:l("font-medium text-900",{"text-red-500":!!i.tax_name,"text-green-500":!i.tax_name&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.tax_name,"pi-check-circle text-green-500 text-sm":!i.tax_name&&s>0})})," Vergi Mükellefi Adı"]}),e.jsx(N,{id:"tax_name",autoComplete:"off",name:"tax_name",tooltip:i.tax_name,tooltipOptions:{position:"top"},disabled:b,onChange:p,value:c.tax_name,className:l("w-full",{"p-invalid":!!i.tax_name})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"tax_number",className:l("font-medium text-900",{"text-red-500":!!i.tax_number,"text-green-500":!i.tax_number&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.tax_number,"pi-check-circle text-green-500 text-sm":!i.tax_number&&s>0})})," Vergi Numarası"]}),e.jsx(N,{id:"tax_number",autoComplete:"off",name:"tax_number",type:"number",tooltip:i.tax_number,tooltipOptions:{position:"top"},disabled:b,onChange:p,value:c.tax_number,className:l("w-full",{"p-invalid":!!i.tax_number})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"tax_office",className:l("font-medium text-900",{"text-red-500":!!i.tax_office,"text-green-500":!i.tax_office&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.tax_office,"pi-check-circle text-green-500 text-sm":!i.tax_office&&s>0})})," Vergi Dairesi"]}),e.jsx(O,{value:c.selectedTaxOffice,onChange:a=>{o("selectedTaxOffice",a.value),o("tax_office",a.value.vergi_dairesi)},options:k,optionLabel:"vergi_dairesi",inputId:"tax_office",placeholder:"Vergi Dairenizi Seçiniz",className:l("w-full",{"p-invalid":!!i.city}),filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"Vergi Dairesi Bulunamadı",emptyFilterMessage:"Vergi Dairesi Bulunamadı",filterBy:"vergi_dairesi",valueTemplate:a=>e.jsxs("span",{children:[E[(a==null?void 0:a.il_id)-1]," - ",a==null?void 0:a.vergi_dairesi," - ",a==null?void 0:a.say_kodu]}),itemTemplate:a=>e.jsxs("span",{children:[E[a.il_id-1]," - ",a.vergi_dairesi," - ",a.say_kodu]})})]}),e.jsxs("div",{className:"field mb-4 col-12 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"tax_address",className:l("font-medium text-900",{"text-red-500":!!i.tax_address,"text-green-500":!i.tax_address&&s>0}),children:[e.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!i.tax_address,"pi-check-circle text-green-500 text-sm":!i.tax_address&&s>0})})," Vergi Adresi"]}),e.jsx(R,{id:"tax_address",autoComplete:"off",name:"tax_address",tooltip:i.tax_address,tooltipOptions:{position:"top"},disabled:b,onChange:p,value:c.tax_address,className:l("w-full",{"p-invalid":!!i.tax_address})})]})]}),e.jsx("div",{className:"col-12",children:e.jsx(B,{label:"Bilgilerimi Kaydet",disabled:!U||!W,loading:b,size:"small",type:"submit",className:"w-auto mt-3"})})]})]})]})]})};export{_e as default};
