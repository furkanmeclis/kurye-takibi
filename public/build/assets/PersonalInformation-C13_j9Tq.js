import{r as y,L as W,R as Z,j as i,c as l,B as M}from"./app-DnzU3dgP.js";import{c as ee,b as r,e as ie,u as te,T as ae,I as v}from"./toast.esm-DRshub8x.js";import{I as le}from"./inputmask.esm-4aE0P5S6.js";import{c as h,t as j,b as se,S as ne,d as re,M as L,D as O,I as $,e as de}from"./message.esm-AnJ8ZL0Q.js";import"./index.esm-p1L-kKDB.js";const ce=async(z,w)=>{let f=route("business.savePersonalInformation"),_=new Headers;return _.append("X-CSRF-TOKEN",w),_.append("Content-Type","application/json"),await(await fetch(f,{method:"POST",headers:_,body:JSON.stringify(z)})).json()},me=async z=>{let w=route("business.getPersonalInformation"),f=new Headers;return f.append("X-CSRF-TOKEN",z),f.append("Content-Type","application/json"),await(await fetch(w,{method:"POST",headers:f})).json()},ge=({page:z=!1,profileCompleted:w=!1,profilePage:f=!1,profileApproved:_=!1,csrfToken:F})=>{var K;const{setBreadcrumbs:R,setLayoutConfig:Y}=y.useContext(W),[H,B]=y.useState(!1),[N,I]=y.useState(_===1),[C,V]=y.useState(0),k=Z.useRef(null),[g,S]=y.useState(!1),[q,G]=y.useState(!1),X=ee().shape({name:r().required("Ad soyad giriniz").min(3,"Ad Soyad en az 3 karakter olmalıdır"),email:r().email("Geçerli bir email adresi giriniz").required("Email adresinizi giriniz"),phone:r().required("Telefon numarası giriniz").matches(/^\(\d{3}\)-\d{3}-\d{4}$/,"Geçerli bir telefon numarası giriniz"),address:r().required("Adresinizi giriniz").min(10,"Adres en az 10 karakter olmalıdır"),city:r().required("Şehir bilgisini seçiniz"),state:r().required("İlçe bilgisini seçiniz"),zip:r().required("Posta kodu giriniz").matches(/^\d{5}$/,"Geçerli bir posta kodu giriniz"),country:r().required("Ülke bilgisini seçiniz"),status:r().nullable(),billing:ie().oneOf(["individual","company"]).required("Fatura türünü seçiniz"),identity:r().when("billing",{is:"individual",then:()=>r().required("Kimlik numarası zorunludur").max(11,"Kimlik numarası 11 karakter olmalıdır").min(11,"Kimlik numarası 11 karakter olmalıdır"),otherwise:()=>r().nullable()}),birth_date:r().when("billing",{is:"individual",then:()=>r().required("Doğum tarihi zorunludur"),otherwise:()=>r().nullable()}),tax_name:r().when("billing",{is:"company",then:()=>r().required("Vergi mükellefi adı zorunludur"),otherwise:()=>r().nullable()}),tax_number:r().when("billing",{is:"company",then:()=>r().required("Vergi numarası zorunludur").max(10,"Vergi numarası 10 karakter olmalıdır").min(10,"Vergi numarası 10 karakter olmalıdır"),otherwise:()=>r().nullable()}),tax_address:r().when("billing",{is:"company",then:()=>r().required("Vergi adresi zorunludur").min(10,"Adres en az 10 karakter olmalıdır"),otherwise:()=>r().nullable()}),tax_office:r().when("billing",{is:"company",then:()=>r().required("Vergi dairesi zorunludur"),otherwise:()=>r().nullable()})});let D=h.map(a=>a.il_adi),T=h[0],P=T.ilceler[0],A=j[0],{values:c,setFieldValue:u,resetForm:E,submitCount:s,setErrors:oe,handleChange:x,handleSubmit:J,errors:e,isValid:Q,dirty:U}=te({initialValues:{name:"",phone:"",email:"",address:"",city:T.il_adi,selectedCity:T,state:P.ilce_adi,selectedState:P,zip:"",country:"turkey",billing:"individual",identity:"",birth_date:new Date(new Date().setFullYear(new Date().getFullYear()-18)),tax_name:"",tax_number:"",tax_address:"",tax_office:A.vergi_dairesi,selectedTaxOffice:A},validationSchema:X,validateOnChange:q,validateOnBlur:q,onSubmit:a=>{let t={};Object.entries(a).forEach(([o,n])=>{if(o==="birth_date"){let m=n;t[o]=`${String(m.getDate()).padStart(2,"0")}.${String(m.getMonth()+1).padStart(2,"0")}.${m.getFullYear()}`}else o!=="selectedCity"&&o!=="selectedState"&&o!=="selectedTaxOffice"&&(t[o]=String(n))}),a.billing==="company"?(t==null||delete t.identity,t==null||delete t.birth_date):a.billing==="individual"&&(t==null||delete t.tax_name,t==null||delete t.tax_number,t==null||delete t.tax_address,t==null||delete t.tax_office),S(!0),ce(t,F).then(o=>{var n,m;if(o.status){let d=o.details,b={name:d.name,phone:d.phone,email:d.email,address:d.address,city:d.city,selectedCity:{},state:d.state,selectedState:{},zip:d.zip,country:d.country,billing:d.billing,identity:d.identity||"",birth_date:new Date,tax_name:d.tax_name||"",tax_number:d.tax_number||"",tax_address:d.tax_address||"",tax_office:d.tax_office||"",selectedTaxOffice:{}};if(b.selectedCity=h.find(p=>p.il_adi===d.city),b.selectedState=b.selectedCity.ilceler.find(p=>p.ilce_adi===d.state),b.billing==="individual"){let p=d.birth_date.split(".");b.birth_date=new Date(parseInt(p[2]),parseInt(p[1])-1,parseInt(p[0]))}else b.billing==="company"&&(b.selectedTaxOffice=j.find(p=>p.vergi_dairesi===d.tax_office));I(d.approved===1),B(d.completed===1),E({values:b}),(n=k.current)==null||n.show({severity:"success",summary:"Başarılı",detail:o.message})}else(m=k.current)==null||m.show({severity:"error",summary:"Hata",detail:o.message})}).catch(o=>{var n;console.error(o),(n=k.current)==null||n.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu lütfen tekrar deneyiniz."})}).finally(()=>{S(!1)})}});return y.useEffect(()=>{s>0&&G(!0)},[s]),y.useEffect(()=>{S(!0),me(F).then(({status:a,details:t,courier:o})=>{if(a){let n={name:t.name,phone:t.phone,email:t.email,address:t.address,city:t.city,selectedCity:{},state:t.state,selectedState:{},zip:t.zip,country:"turkey",billing:t.billing,identity:t.identity||"",birth_date:new Date,tax_name:t.tax_name||"",tax_number:t.tax_number||"",tax_address:t.tax_address||"",tax_office:t.tax_office||"",selectedTaxOffice:{},vehicle_type:t.vehicle_type};if(t.city!==null?(n.selectedCity=h.find(m=>m.il_adi===t.city),t.state!==null&&(n.selectedState=n.selectedCity.ilceler.find(m=>m.ilce_adi===t.state))):(n.selectedCity=h[0],n.selectedState=h[0].ilceler[0],n.city=h[0].il_adi,n.state=h[0].ilceler[0].ilce_adi),n.billing==="individual")if((t==null?void 0:t.birth_date)!==null){let m=t.birth_date.split(".");n.birth_date=new Date(parseInt(m[2]),parseInt(m[1])-1,parseInt(m[0]))}else n.birth_date=new Date;else n.billing==="company"&&((n==null?void 0:n.tax_office)!==null?n.selectedTaxOffice=j.find(m=>m.vergi_dairesi===t.tax_office):(n.selectedTaxOffice=j[0],n.tax_office=j[0].vergi_dairesi));I((t==null?void 0:t.approved)===1),B((t==null?void 0:t.completed)===1),E({values:n})}}).catch(a=>{var t;console.log(a),(t=k.current)==null||t.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu lütfen tekrar deneyiniz."})}).finally(()=>{S(!1)}),f||(R([]),Y(a=>({...a,menuMode:"overlay"})))},[]),i.jsxs("div",{className:"card",children:[i.jsx(ae,{ref:k}),!f&&i.jsx("span",{className:"text-900 text-xl font-bold mb-4 block",children:"Profilinizi Tamamlayın"}),i.jsxs("div",{className:"grid",children:[i.jsxs("div",{className:"col-12 lg:col-2",children:[i.jsx("div",{className:"text-900 font-medium text-xl mb-3",children:"Kişisel Bilgileriniz"}),i.jsxs("p",{className:"m-0 p-0 text-600 line-height-3 mr-3",children:["Sistemdeki bilgilerinizin güncel olması gerekmektedir. Lütfen aşağıdaki alanları doldurunuz.",!_&&"Onay sürecinden sonra üyeliğiniz aktif edilecektir."]}),(C===1||N)&&i.jsxs(i.Fragment,{children:[i.jsx(se,{}),i.jsxs("div",{className:"field mb-4 w-full",children:[i.jsxs("label",{htmlFor:"billing",className:l("font-medium text-900",{"text-red-500":!!e.billing,"text-green-500":!e.billing&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.billing,"pi-check-circle text-green-500 text-sm":!e.billing&&s>0})})," Faturalandırma Türü"]}),i.jsx(ne,{options:[{name:"Bireysel",value:"individual",icon:"pi pi-user"},{name:"Kurumsal",value:"company",icon:"pi pi-briefcase"}],optionLabel:"name",tooltip:"Bireysel / Kurumsal",tooltipOptions:{position:"top"},className:"w-full",itemTemplate:a=>i.jsx("div",{className:"flex align-items-center",title:a.name,children:i.jsx("i",{className:a.icon+" text-xl"})}),allowEmpty:!1,optionValue:"value",value:c.billing,onChange:a=>{a.value!==null&&u("billing",a.value)}})]})]})]}),i.jsxs("div",{className:"col-12 lg:col-10",children:[!N&&i.jsx(re,{model:[{label:"Giriş"},{label:"Detaylar"}],readOnly:!1,onSelect:a=>V(a.index),activeIndex:C,className:"mb-4"}),C===0&&!N&&i.jsxs(i.Fragment,{children:[i.jsx("div",{children:H?!N&&i.jsx(L,{className:"w-full",severity:"success",text:"Profil Bilgilerinizi Kaydettiniz Ancak *Yönetici Onayı* Beklemektedir. Değiştirmek istediğiniz bilgileri sonraki ekrandan yönetebilirsiniz."}):i.jsx(i.Fragment,{children:i.jsx(L,{className:"w-full",severity:"warn",text:"Profil Bilgilerinizi Sonraki Formdan Ekleyiniz. Onay sürecinden sonra üyeliğiniz aktif edilecektir."})})}),i.jsx("div",{className:"grid",children:i.jsx("div",{className:"col-12 flex justify-content-end mt-4",children:i.jsx(M,{label:"İlerle",size:"small",severity:"success",icon:"pi pi-arrow-right",onClick:()=>{V(1)}})})})]}),(C===1||N)&&i.jsxs("form",{onSubmit:J,className:"grid formgrid p-fluid",children:[i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"name",className:l("font-medium text-900",{"text-red-500":!!e.name,"text-green-500":!e.name&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.name,"pi-check-circle text-green-500 text-sm":!e.name&&s>0})})," Ad Soyad"]}),i.jsx(v,{id:"name",type:"text",autoComplete:"off",name:"name",tooltip:e.name,tooltipOptions:{position:"top"},readOnly:!0,disabled:!0,onChange:x,value:c.name,className:l("w-full",{"p-invalid":!!e.name})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"email",className:l("font-medium text-900",{"text-red-500":!!e.email,"text-green-500":!e.email&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.email,"pi-check-circle text-green-500 text-sm":!e.email&&s>0})})," Email Adresi"]}),i.jsx(v,{id:"email",type:"email",autoComplete:"off",name:"email",readOnly:!0,tooltip:e==null?void 0:e.email,tooltipOptions:{position:"top"},disabled:!0,onChange:x,value:c.email,className:l("w-full",{"p-invalid":!!e.email})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"phone",className:l("font-medium text-900",{"text-red-500":!!e.phone,"text-green-500":!e.phone&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.phone,"pi-check-circle text-green-500 text-sm":!e.phone&&s>0})})," Telefon Numarası"]}),i.jsx(le,{autoComplete:"off",name:"phone",readOnly:!0,tooltip:e==null?void 0:e.phone,tooltipOptions:{position:"top",event:"focus",className:"text-red-500"},disabled:!0,onChange:x,value:c.phone,mask:"(999)-999-9999",className:l("w-full",{"p-invalid":!!e.phone})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"city",className:l("font-medium text-900",{"text-red-500":!!e.city,"text-green-500":!e.city&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.city,"pi-check-circle text-green-500 text-sm":!e.city&&s>0})})," İl"]}),i.jsx(O,{value:c.selectedCity,onChange:a=>{u("city",a.value.il_adi),u("selectedCity",a.value),u("state",a.value.ilceler[0].ilce_adi),u("selectedState",a.value.ilceler[0])},options:h,optionLabel:"il_adi",inputId:"city",placeholder:"Şehir Seçiniz",className:l("w-full",{"p-invalid":!!e.city}),filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"Şehir Bulunamadı",emptyFilterMessage:"Şehir Bulunamadı",filterBy:"il_adi"})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"state",className:l("font-medium text-900",{"text-red-500":!!e.state,"text-green-500":!e.state&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.state,"pi-check-circle text-green-500 text-sm":!e.state&&s>0})})," İlçe"]}),i.jsx(O,{value:c.selectedState,inputId:"state",disabled:c.selectedCity===null,onChange:a=>{u("state",a.value.ilce_adi),u("selectedState",a.value)},options:(K=c.selectedCity)==null?void 0:K.ilceler,optionLabel:"ilce_adi",placeholder:"İlçe Seçiniz",className:l("w-full",{"p-invalid":!!e.state}),filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"İlçe Bulunamadı",emptyFilterMessage:"İlçe Bulunamadı",filterBy:"ilce_adi"})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"country",className:l("font-medium text-900",{"text-red-500":!!e.country,"text-green-500":!e.country&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.country,"pi-check-circle text-green-500 text-sm":!e.country&&s>0})})," Ülke"]}),i.jsx(O,{value:"turkey",inputId:"country",options:[{label:"Türkiye",value:"turkey"}],optionLabel:"label",placeholder:"Ülke Seçiniz",className:l("w-full",{"p-invalid":!!e.country})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"name",className:l("font-medium text-900",{"text-red-500":!!e.zip,"text-green-500":!e.zip&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.zip,"pi-check-circle text-green-500 text-sm":!e.zip&&s>0})})," Posta Kodu"]}),i.jsx(v,{id:"name",type:"text",autoComplete:"off",name:"zip",tooltip:e.zip,tooltipOptions:{position:"top"},disabled:g,onChange:x,value:c.zip,className:l("w-full",{"p-invalid":!!e.zip})})]}),i.jsxs("div",{className:"field mb-4 col-12  p-input-icon-right",children:[i.jsxs("label",{htmlFor:"address",className:l("font-medium text-900",{"text-red-500":!!e.address,"text-green-500":!e.address&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.address,"pi-check-circle text-green-500 text-sm":!e.address&&s>0})})," Adres"]}),i.jsx($,{id:"name",autoComplete:"off",name:"address",tooltip:e.address,tooltipOptions:{position:"top"},disabled:g,onChange:x,value:c.address,className:l("w-full",{"p-invalid":!!e.address})})]}),c.billing==="individual"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"identity",className:l("font-medium text-900",{"text-red-500":!!e.identity,"text-green-500":!e.identity&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.identity,"pi-check-circle text-green-500 text-sm":!e.identity&&s>0})})," Kimlik Numarası"]}),i.jsx(v,{id:"identity",autoComplete:"off",name:"identity",tooltip:e.identity,tooltipOptions:{position:"top"},disabled:g,onChange:x,value:c.identity,className:l("w-full",{"p-invalid":!!e.identity})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"birth_date",className:l("font-medium text-900",{"text-red-500":!!e.birth_date,"text-green-500":!e.birth_date&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.birth_date,"pi-check-circle text-green-500 text-sm":!e.birth_date&&s>0})})," Doğum Tarihi (gg.aa.yyyy)"]}),i.jsx(de,{inputId:"birth_date",name:"birth_date",disabled:g,tooltip:(e==null?void 0:e.birth_date)&&String(e==null?void 0:e.birth_date),tooltipOptions:{position:"top"},maxDate:new Date(new Date().setFullYear(new Date().getFullYear()-18)),onChange:a=>{u("birth_date",a.value)},value:c.birth_date,className:l("w-full",{"p-invalid":!!e.birth_date})})]})]}),c.billing==="company"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"tax_name",className:l("font-medium text-900",{"text-red-500":!!e.tax_name,"text-green-500":!e.tax_name&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.tax_name,"pi-check-circle text-green-500 text-sm":!e.tax_name&&s>0})})," Vergi Mükellefi Adı"]}),i.jsx(v,{id:"tax_name",autoComplete:"off",name:"tax_name",tooltip:e.tax_name,tooltipOptions:{position:"top"},disabled:g,onChange:x,value:c.tax_name,className:l("w-full",{"p-invalid":!!e.tax_name})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"tax_number",className:l("font-medium text-900",{"text-red-500":!!e.tax_number,"text-green-500":!e.tax_number&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.tax_number,"pi-check-circle text-green-500 text-sm":!e.tax_number&&s>0})})," Vergi Numarası"]}),i.jsx(v,{id:"tax_number",autoComplete:"off",name:"tax_number",type:"number",tooltip:e.tax_number,tooltipOptions:{position:"top"},disabled:g,onChange:x,value:c.tax_number,className:l("w-full",{"p-invalid":!!e.tax_number})})]}),i.jsxs("div",{className:"field mb-4 col-12 md:col-4 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"tax_office",className:l("font-medium text-900",{"text-red-500":!!e.tax_office,"text-green-500":!e.tax_office&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.tax_office,"pi-check-circle text-green-500 text-sm":!e.tax_office&&s>0})})," Vergi Dairesi"]}),i.jsx(O,{value:c.selectedTaxOffice,onChange:a=>{u("selectedTaxOffice",a.value),u("tax_office",a.value.vergi_dairesi)},options:j,optionLabel:"vergi_dairesi",inputId:"tax_office",placeholder:"Vergi Dairenizi Seçiniz",className:l("w-full",{"p-invalid":!!e.city}),filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"Vergi Dairesi Bulunamadı",emptyFilterMessage:"Vergi Dairesi Bulunamadı",filterBy:"vergi_dairesi",valueTemplate:a=>i.jsxs("span",{children:[D[(a==null?void 0:a.il_id)-1]," - ",a==null?void 0:a.vergi_dairesi," - ",a==null?void 0:a.say_kodu]}),itemTemplate:a=>i.jsxs("span",{children:[D[a.il_id-1]," - ",a.vergi_dairesi," - ",a.say_kodu]})})]}),i.jsxs("div",{className:"field mb-4 col-12 p-input-icon-right",children:[i.jsxs("label",{htmlFor:"tax_address",className:l("font-medium text-900",{"text-red-500":!!e.tax_address,"text-green-500":!e.tax_address&&s>0}),children:[i.jsx("i",{className:l("pi",{"pi-times-circle text-red-500 text-sm":!!e.tax_address,"pi-check-circle text-green-500 text-sm":!e.tax_address&&s>0})})," Vergi Adresi"]}),i.jsx($,{id:"tax_address",autoComplete:"off",name:"tax_address",tooltip:e.tax_address,tooltipOptions:{position:"top"},disabled:g,onChange:x,value:c.tax_address,className:l("w-full",{"p-invalid":!!e.tax_address})})]})]}),i.jsx("div",{className:"col-12",children:i.jsx(M,{label:"Bilgilerimi Kaydet",disabled:!Q||!U,loading:g,size:"small",type:"submit",className:"w-auto mt-3"})})]})]})]})]})};export{ge as default};
