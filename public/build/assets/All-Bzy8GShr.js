import{r as p,u as D,j as e,B as d,y as w,R as N,Y as G,a as k}from"./app-j6PEhqpP.js";import{P as O,M as F}from"./PageContainer-CNKbsat-.js";import{T as H}from"./toast.esm-wwTx3ct0.js";import{g as A,d as B,m as E}from"./customer-CjbiwGLN.js";import{D as K,C as V}from"./column.esm-Cm-MnQRw.js";import{M as z}from"./message.esm-6Xok8xo0.js";import{C as $,T as I}from"./checkbox.esm-DToyUyZG.js";import{O as Y}from"./ActiveOrder-D2ZjGFlE.js";import"./PersonalInformation-BfZYf5oV.js";import"./inputtext.esm-DVoroEiL.js";import"./inputmask.esm-Dm9AOoXZ.js";import"./PersonalInformation-DkiGRzm-.js";import"./globalHelper-DC93hlCg.js";import"./styleclass.esm-ChhZHvQm.js";import"./sidebar.esm-fF8ZoMoc.js";import"./index.esm-fbcK3nX0.js";import"./inputswitch.esm-DWu5y5pa.js";import"./index.esm-X8ib2Dew.js";const de=({auth:T,csrfToken:h,flash:n})=>{const[x,l]=p.useState(!0),[u,y]=p.useState([]),[f,g]=p.useState([]),[i,C]=D(["name","phone","note","created_at","actions"],"businessCustomersTableColumns"),[j,b]=p.useState(null),S=()=>{l(!0),A(h).then(t=>{t.status?(y(t.customers),l(!1),b(null)):(b(t.message),l(!1))}).catch(t=>{b(t.message),l(!1)}).finally(()=>l(!1))};p.useEffect(()=>{var t;S(),n!=null&&n.message&&((t=o.current)==null||t.show({severity:(n==null?void 0:n.type)??"info",summary:n.title,detail:n.message??""}))},[]);const L=(t,r)=>{k({target:t.currentTarget,message:"Müşteriyi silmek istediğinize emin misiniz?",acceptLabel:"Sil",acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){l(!0),B(r,h).then(({status:a,message:s})=>{var c,m;a?(y(u.filter(v=>v.id!==r)),g([]),(c=o.current)==null||c.show({severity:"success",summary:"Başarılı",detail:s})):(m=o.current)==null||m.show({severity:"error",summary:"Hata",detail:s})}).catch(a=>{var s;(s=o.current)==null||s.show({severity:"error",summary:"Hata",detail:a.message})}).finally(()=>l(!1))}})},R=(t,r)=>{k({target:t.currentTarget,message:"Seçilen Müşteriler silinecektir. Silmek istediğinize emin misiniz?",acceptLabel:`Sil (${r.length} Müşteri)`,acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){l(!0),E(r,h).then(({status:a,message:s})=>{var c,m;a?(y(u.filter(v=>!r.includes(v.id))),g([]),(c=o.current)==null||c.show({severity:"success",summary:"Başarılı",detail:s})):(m=o.current)==null||m.show({severity:"error",summary:"Hata",detail:s})}).catch(a=>{var s;(s=o.current)==null||s.show({severity:"error",summary:"Hata",detail:a.message})}).finally(()=>l(!1))}})};let M=[{selectionMode:"multiple",headerStyle:{width:"3rem"},header:""},{field:"name",header:"Müşteri Adı",hidden:!i.includes("name"),sortable:!0,filter:!0,filterPlaceholder:"Ad'a Göre"},{field:"phone",header:"Telefon Numarası",hidden:!i.includes("phone"),sortable:!0,filter:!0,filterPlaceholder:"Telefon Numarası'na Göre"},{field:"note",header:"Not(Sadece İşletme Görebilir)",hidden:!i.includes("note"),sortable:!0,filter:!0,filterPlaceholder:"Not'a Göre"},{field:"created_at",header:"Kayıt Tarihi",hidden:!i.includes("created_at"),sortable:!0,filter:!0,filterPlaceholder:"Kayıt Tarihine Göre",filterType:"date",body:t=>e.jsx("span",{children:new Date(t.created_at).toLocaleString()})},{field:"updated_at",header:"Güncelleme Tarihi",hidden:!i.includes("updated_at"),sortable:!0,filter:!0,filterPlaceholder:"Güncellenme Tarihine Göre",filterType:"date",body:t=>e.jsx("span",{children:new Date(t.updated_at).toLocaleString()})},{field:"actions",header:"İşlemler",hidden:!i.includes("actions"),body:t=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{size:"small",icon:"pi pi-map-marker",severity:"info",tooltip:"Adresler",tooltipOptions:{position:"top"},onClick:()=>{w.visit(route("business.customers.edit",{id:t.id}))}}),e.jsx(d,{size:"small",icon:"pi pi-pencil",severity:"warning",tooltip:"Düzenle",tooltipOptions:{position:"top"},onClick:()=>{w.visit(route("business.customers.edit",{id:t.id}))}}),e.jsx(d,{size:"small",icon:"pi pi-trash",severity:"danger",tooltip:"Sil",tooltipOptions:{position:"top"},onClick:r=>{L(r,t.id)}})]})}];const P=N.useRef(null),_=()=>e.jsx(e.Fragment,{children:e.jsx(I,{start:f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"small",icon:"pi pi-trash",className:"mr-2",tooltip:"Seçilen Müşterileri Silmenizi Sağlar",tooltipOptions:{position:"top"},label:"Sil ("+f.length+")",severity:"danger",onClick:t=>{R(t,f.map(r=>r.id))}}),e.jsx(d,{size:"small",icon:"pi pi-filter-slash",label:"Seçimi Temizle",severity:"warning",onClick:()=>g([])})]}),end:e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"small",icon:"pi pi-sync",severity:"help",className:"mr-2",tooltip:"Verileri Yenile",tooltipOptions:{position:"top"},onClick:()=>{S()}}),e.jsx(d,{size:"small",icon:"pi pi-bars",onClick:t=>{var r;(r=P.current)==null||r.toggle(t)}})]})})}),o=N.useRef(null);return e.jsx(O,{auth:T,csrfToken:h,children:e.jsxs(F,{children:[e.jsx(G,{title:"Müşteriler"}),e.jsx(H,{ref:o}),e.jsxs(Y,{ref:P,showCloseIcon:!0,style:{width:"300px"},children:[e.jsx("div",{className:"flex align-items-center justify-content-start mb-3",children:e.jsxs("span",{className:"text-900 text-lg font-bold",children:["Sütunlar (",i.length,")"]})}),e.jsx("div",{className:"flex flex-column justify-content-center gap-2",children:M.map((t,r)=>{if(t.selectionMode==="multiple")return null;let a=t.header,s=t.field;return e.jsxs("div",{className:"flex align-items-center",children:[e.jsx($,{inputId:`column${r}`,checked:i.includes(s),onChange:c=>{c.checked?C([...i,s]):C(i.filter(m=>m!==s))}}),e.jsx("label",{htmlFor:`column${r}`,className:"ml-2",children:a})]},r)})})]}),e.jsxs("div",{className:"card",children:[e.jsx("span",{className:"text-900 text-xl font-bold mb-4 block",children:"Müşteriler"}),j!==null&&e.jsx(z,{className:"w-full",severity:"error",text:j}),!x&&u.length===0&&e.jsx(z,{className:"w-full",severity:"info",text:"Müşteri bulunamadı."}),e.jsx(K,{hidden:!x&&u.length===0||j!==null,loading:x,value:u,removableSort:!0,paginator:!0,filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",header:_,filters:{name:{value:null,matchMode:"contains"},phone:{value:null,matchMode:"contains"},created_at:{value:null,matchMode:"contains"},updated_at:{value:null,matchMode:"contains"},note:{value:null,matchMode:"contains"}},emptyMessage:"Müşteri bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",selectionMode:"checkbox",selection:f,onSelectionChange:t=>g(t.value),children:M.map((t,r)=>e.jsx(V,{...t},r))})]})]})})};export{de as default};
