import{r as n,L as M,j as s,Y as C,B as h,T as E,b as O,y as K}from"./app-BUYDDfPN.js";import{L as x,s as $,f as H,r as P,e as R,M as b,b as j,c as f,P as y,h as G,A as c,T as I,d as q,i as F}from"./ActiveOrder-RoMsLiRo.js";import{P as U,M as W}from"./PageContainer-Dnv8chOX.js";import{T as Y}from"./toast.esm-CXYhB19S.js";import{b as N,c as Z}from"./globalHelper-B-s3UrsJ.js";import{b as V,m as J,c as Q}from"./PersonalInformation-D2mauVoN.js";import"./index.esm-Dp1QBIFe.js";import"./sidebar.esm-o99qc0us.js";import"./PersonalInformation-BwaR2gCa.js";import"./inputtext.esm-CXYMOS3i.js";import"./inputmask.esm-BV_Q9Uun.js";import"./message.esm-J9njUTBM.js";import"./styleclass.esm-Bvcw6aD6.js";const v=new x.Icon({iconUrl:$,iconSize:[32,32],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),X=new x.Icon({iconUrl:H,iconSize:[32,32],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),w=new x.Icon({iconUrl:P,iconSize:[16,16],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),xe=({auth:_,csrfToken:u,orderId:g,courierIsTransporting:S=!1})=>{const[e,k]=n.useState(null),[D,r]=n.useState(!0),a=n.useRef(null),z=()=>{r(!0),G(g,u).then(l=>{var i;l.status?k(l.order):(i=a.current)==null||i.show({summary:"Hata",detail:l.message,severity:"error"})}).catch(l=>{var i;console.error(l),(i=a.current)==null||i.show({summary:"Hata",detail:"Bir Hata Oluştu",severity:"error"})}).finally(()=>r(!1))};n.useEffect(()=>{z()},[]);const[m,ee]=n.useState([]),[A,se]=n.useState(!1),{setBreadcrumbs:B}=n.useContext(M);n.useEffect(()=>{B(l=>[...l,{labels:["Yeni Siparişler","Siparişi Görüntüle"],to:window.location.href}])},[]);const T=l=>{let i=new Date(l.created_at),t=l.courier_accepted_at!==null?new Date(l.courier_accepted_at):null,o=l.delivered_at!==null?new Date(l.delivered_at):null,p=l.canceled_at!==null?new Date(l.canceled_at):null,d=[];return p!==null&&d.push({date:p,status:"Sipariş İptal Edildi",icon:"pi pi-times-circle",bg:"red-500"}),o!==null&&d.push({date:o,status:"Sipariş Teslim Edildi",icon:"pi pi-send",bg:"green-500"}),t!==null&&d.push({date:t,status:"Kurye Kabul Etti",icon:"pi pi-check-square",bg:"teal-500"}),d.push({date:i,status:"Sipariş Oluşturuldu",icon:"pi pi-file-import",bg:"yellow-500"}),d},L=()=>s.jsxs("div",{className:"grid",children:[e!==null&&s.jsx("div",{className:"col-12 lg:col-9 md:col-8",children:s.jsxs("div",{children:[s.jsx(E,{target:"[data-pr-tooltip]",position:"bottom",className:"zoomin"}),s.jsxs("div",{className:"grid row-gap-2",children:[s.jsx("div",{className:"col-12",children:s.jsx("span",{className:"text-xl font-semibold",children:"Sipariş Bilgileri"})}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Müşteri Adı Soyadı",children:[s.jsx(c,{icon:"pi pi-user",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx(O,{className:"font-semibold ml-2 text-color dark: text-decoration-none",href:route("business.customers.edit",e==null?void 0:e.customer.id),children:e==null?void 0:e.customer.name})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Müşteri Telefon Numarası",children:[s.jsx(c,{icon:"pi pi-phone",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("a",{className:"font-semibold ml-2 text-color text-decoration-none",href:`tel:${e==null?void 0:e.customer.phone}`,children:e==null?void 0:e.customer.phone})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Paket Ücreti",children:[s.jsx(c,{icon:"pi pi-turkish-lira",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsxs("span",{className:"font-semibold ml-2",children:[e==null?void 0:e.price," ₺"]})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Sipariş Durumu",children:[s.jsx(c,{icon:"pi pi-check",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx(I,{className:"ml-2",value:N(e==null?void 0:e.status).label,severity:N(e==null?void 0:e.status).severity})]}),(e==null?void 0:e.status)==="canceled"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"col-12",children:s.jsx("span",{className:"text-xl font-semibold",children:"İptal Bilgileri"})}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"İptal Edilme Sebebi",children:[s.jsx(c,{icon:"pi pi-file",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:e==null?void 0:e.cancellation_reason})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"İptal Edilme Sebebi",children:[s.jsx(c,{icon:`pi pi-${(e==null?void 0:e.cancellation_accepted)===1?"check":"times"}-circle`,shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:(e==null?void 0:e.cancellation_accepted)===1?"İptal Onaylandı":"İptal İşlemi Onay Bekliyor"})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"İptal Edilme Tarihi",children:[s.jsx(c,{icon:"pi pi-clock",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:new Date(String(e==null?void 0:e.canceled_at)).toLocaleString()})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Onaylayan Yetkili",children:[s.jsx(c,{icon:"pi pi-user",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:(e==null?void 0:e.cancellation_accepted_by)!==null?e==null?void 0:e.cancellation_accepted_by.name:"Onaylanmadı"})]})]}),s.jsx("div",{className:"col-12",children:s.jsx("span",{className:"text-xl font-semibold",children:"Adres Bilgileri"})}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Adres Başlığı",children:[s.jsx(c,{icon:"pi pi-tag",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:e==null?void 0:e.address.title})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Adres Telefon Numarası",children:[s.jsx(c,{icon:"pi pi-phone",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("a",{className:"font-semibold ml-2 text-color text-decoration-none",href:`tel:${e==null?void 0:e.address.phone}`,children:e==null?void 0:e.address.phone})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"İl/İlçe",children:[s.jsx(c,{icon:"pi pi-map",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsxs("span",{className:"font-semibold ml-2",children:[e==null?void 0:e.address.city," / ",e==null?void 0:e.address.district]})]}),s.jsxs("div",{className:"lg:col-6 md:col-6 col-12 cursor-pointer","data-pr-tooltip":"Adres",children:[s.jsx(c,{icon:"pi pi-home",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{"data-pr-position":"bottom",className:"font-semibold ml-2",children:e==null?void 0:e.address.address})]}),(e==null?void 0:e.address.notes)!==null&&s.jsxs("div",{className:"lg:col-6 md:col-6 col-12 cursor-pointer","data-pr-tooltip":"Notlar",children:[s.jsx(c,{icon:"pi pi-info",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:e==null?void 0:e.address.notes})]}),(e==null?void 0:e.courier)!==!1&&(e==null?void 0:e.courier)!==null&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"col-12",children:s.jsx("span",{className:"text-xl font-semibold",children:"Kurye Bilgileri"})}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Kurye Adı Soyadı",children:[s.jsx(c,{icon:"pi pi-user",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:e==null?void 0:e.courier.name})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Kurye Telefon Numarası",children:[s.jsx(c,{icon:"pi pi-phone",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("a",{className:"font-semibold ml-2 text-color text-decoration-none",href:`tel:${e==null?void 0:e.courier.phone}`,children:e==null?void 0:e.courier.phone})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Kurye Email Adresi",children:[s.jsx(c,{icon:"pi pi-envelope",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("a",{className:"font-semibold ml-2 text-color text-decoration-none",href:`mailto:${e==null?void 0:e.courier.email}`,children:e==null?void 0:e.courier.email})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer flex align-items-center","data-pr-tooltip":"Teslimat Tipi",children:[s.jsx(c,{image:(e==null?void 0:e.courier.details.vehicle_type)==="bicycle"?V:(e==null?void 0:e.courier.details.vehicle_type)==="motorcycle"?J:Q,className:"bg-primary-300 font-semibold text-primary-800 p-1"}),s.jsx("span",{className:"ml-2 font-semibold",children:(e==null?void 0:e.courier.details.vehicle_type)==="bicycle"?"Bisiklet":(e==null?void 0:e.courier.details.vehicle_type)==="motorcycle"?"Motosiklet":"Araba"})]}),s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Siparişi Teslim Alma Tarihi",children:[s.jsx(c,{icon:"pi pi-clock",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:(e==null?void 0:e.courier_accepted_at)!==null?new Date(e==null?void 0:e.courier_accepted_at).toLocaleString():"-"})]}),(e==null?void 0:e.delivered_at)!==null&&s.jsxs("div",{className:"lg:col-3 md:col-4 col-6 cursor-pointer","data-pr-tooltip":"Siparişi Teslim Etme Tarihi",children:[s.jsx(c,{icon:"pi pi-stop-circle",shape:"circle",className:"bg-primary-300 font-semibold text-primary-800"}),s.jsx("span",{className:"font-semibold ml-2",children:new Date(e==null?void 0:e.delivered_at).toLocaleString()})]}),!A&&m.length>0&&s.jsx("div",{className:"col-12",children:s.jsxs(b,{center:[m[0].latitude,m[0].longitude],zoom:15,zoomControl:!0,attributionControl:!1,style:{height:"400px",borderRadius:"10px"},scrollWheelZoom:!1,children:[s.jsx(j,{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),m.map((l,i)=>s.jsx(f,{position:[l.latitude,l.longitude],icon:i===0?v:i===m.length-1&&(e==null?void 0:e.status)==="delivered"?X:w,children:s.jsxs(y,{children:[s.jsx("span",{className:"font-semibold flex justify-content-center text-lg",children:i===0?"Başlangıç":i===m.length-1&&(e==null?void 0:e.status)==="delivered"?"Bitiş":"Güzergah-"+i}),s.jsx(h,{label:"Google Maps'te Aç",size:"small",icon:"pi pi-external-link",severity:"help",className:"w-full mt-2 zoomindown",onClick:()=>{window.open(`https://www.google.com/maps/search/?api=1&query=${l.latitude},${l.longitude}`,"_blank")}})]})},i))]})})]})]})]})}),s.jsx("div",{className:"col-12 lg:col-3 md:col-4",children:s.jsx(q,{layout:"vertical",marker:l=>s.jsx("span",{className:`bg-${l.bg} flex w-2rem h-2rem align-items-center justify-content-center text-white border-circle z-1 shadow-1`,children:s.jsx("i",{className:l.icon})}),value:T(e),opposite:l=>l.status,content:l=>s.jsx("small",{className:"text-color-secondary",children:l.date.toLocaleString()})})})]});return s.jsx(U,{auth:_,csrfToken:u,courierIsTransporting:S,children:s.jsxs(W,{children:[s.jsx(Y,{ref:a}),s.jsx(C,{title:"Siparişi İncele"}),s.jsxs("div",{className:"card",children:[s.jsx("span",{className:"text-900 text-xl font-bold mb-2 block",children:"Siparişi Al"}),s.jsx(h,{label:"Kabul Et",severity:"success",onClick:l=>{R({header:"Bu Siparişi Almak İstediğinize Emin misiniz ?",message:"Onayladıktan Sonra Konumunuz İzlenmeye Başlayacaktır",icon:"pi pi-info-circle",acceptClassName:"p-button-success",draggable:!1,rejectLabel:"Vazgeç",accept(){r(!0),Z(a.current).then(i=>{F(g,i.latitude,i.longitude,u).then(t=>{var o,p;t.status?((o=a.current)==null||o.show({severity:"success",summary:"Başarılı",detail:t.message}),K.reload()):(p=a.current)==null||p.show({severity:"error",summary:"Hata",detail:t.message})}).catch(t=>{var o;console.log(t),r(!1),(o=a.current)==null||o.show({severity:"error",summary:"Hata",detail:"Bir Hata Oluştu"})}).finally(()=>r(!1))}).catch(i=>{var t;console.log(i),r(!1),(t=a.current)==null||t.show({severity:"error",summary:"Hata",detail:"Konum Bilginiz Alınamadı"})})}})}})]}),e!==null&&s.jsx("div",{className:"card",children:s.jsxs("div",{className:"grid",children:[s.jsx("div",{className:"col-12",children:s.jsx("span",{className:"text-xl font-semibold",children:"İşletme Konumu"})}),s.jsx("div",{className:"col-12",children:s.jsxs(b,{center:[e.business.details.latitude,e.business.details.longitude],zoom:15,zoomControl:!0,attributionControl:!1,style:{height:"350px",borderRadius:"10px"},scrollWheelZoom:!1,children:[s.jsx(j,{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),s.jsx(f,{position:[e.business.details.latitude,e.business.details.longitude],icon:v,children:s.jsxs(y,{children:[s.jsx("span",{className:"font-semibold flex justify-content-center text-lg",children:"İşletme Konumu"}),s.jsx(h,{label:"Google Maps'te Aç",size:"small",icon:"pi pi-external-link",severity:"help",className:"w-full mt-2",onClick:()=>{window.open(`https://www.google.com/maps/search/?api=1&query=${e.business.details.latitude},${e.business.details.longitude}`,"_blank")}})]})})]})})]})}),s.jsx("div",{className:"card",children:e!==null&&s.jsx(L,{})})]})})};export{xe as default};
