import{C as ae,r as o,P as le,D as y,O as ce,g as ie,w as Z,c as oe}from"./app-BF3BFKmb.js";import{I as se}from"./inputtext.esm-vpht0prC.js";function A(){return A=Object.assign?Object.assign.bind():function(I){for(var h=1;h<arguments.length;h++){var x=arguments[h];for(var n in x)Object.prototype.hasOwnProperty.call(x,n)&&(I[n]=x[n])}return I},A.apply(this,arguments)}var Y=ae.extend({defaultProps:{__TYPE:"InputMask",autoClear:!0,autoFocus:!1,className:null,disabled:!1,id:null,mask:null,maxLength:null,name:null,onBlur:null,onChange:null,onComplete:null,onFocus:null,placeholder:null,readOnly:!1,required:!1,size:null,slotChar:"_",style:null,tabIndex:null,tooltip:null,tooltipOptions:null,type:"text",unmask:!1,value:null,children:void 0}}),fe=o.memo(o.forwardRef(function(I,h){var x=o.useContext(le),n=Y.getProps(I,x),a=o.useRef(null),b=o.useRef(null),B=o.useRef(0),s=o.useRef([]),f=o.useRef([]),v=o.useRef(0),M=o.useRef(null),N=o.useRef(!1),P=o.useRef(null),_=o.useRef(null),R=o.useRef(null),E=o.useRef(null),S=o.useRef(null),K=o.useRef(!1),G={props:n},p=function(e,t){var r,u,l,i=a.current;if(!(!i||!i.offsetParent||i!==document.activeElement))if(typeof e=="number")u=e,l=typeof t=="number"?t:u,i.setSelectionRange?i.setSelectionRange(u,l):i.createTextRange&&(r=i.createTextRange(),r.collapse(!0),r.moveEnd("character",l),r.moveStart("character",u),r.select());else return i.setSelectionRange?(u=i.selectionStart,l=i.selectionEnd):document.selection&&document.selection.createRange&&(r=document.selection.createRange(),u=0-r.duplicate().moveStart("character",-1e5),l=u+r.text.length),{begin:u,end:l}},D=function(){for(var e=b.current;e<=B.current;e++)if(s.current[e]&&f.current[e]===d(e))return!1;return!0},d=o.useCallback(function(c){return c<n.slotChar.length?n.slotChar.charAt(c):n.slotChar.charAt(0)},[n.slotChar]),F=function(){return n.unmask?w():a.current&&a.current.value},C=function(e){for(;++e<v.current&&!s.current[e];);return e},J=function(e){for(;--e>=0&&!s.current[e];);return e},T=function(e,t){var r,u;if(!(e<0)){for(r=e,u=C(t);r<v.current;r++)if(s.current[r]){if(u<v.current&&s.current[r].test(f.current[u]))f.current[r]=f.current[u],f.current[u]=d(u);else break;u=C(u)}k(),p(Math.max(b.current,e))}},Q=function(e){var t,r,u,l;for(t=e,r=d(e);t<v.current;t++)if(s.current[t])if(u=C(t),l=f.current[t],f.current[t]=r,u<v.current&&s.current[u].test(l))r=l;else break},W=function(e){var t=a.current.value,r=p();if(M.current.length&&M.current.length>t.length){for(g(!0);r.begin>0&&!s.current[r.begin-1];)r.begin--;if(r.begin===0)for(;r.begin<b.current&&!s.current[r.begin];)r.begin++;p(r.begin,r.begin)}else{for(g(!0);r.begin<v.current&&!s.current[r.begin];)r.begin++;p(r.begin,r.begin)}n.onComplete&&D()&&n.onComplete({originalEvent:e,value:F()}),m(e)},L=function(e){if(N.current=!1,g(),m(e),V(),n.onBlur&&n.onBlur(e),a.current.value!==P.current){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),a.current.dispatchEvent(t)}},X=function(e){if(!n.readOnly){var t=e.which||e.keyCode,r,u,l;M.current=a.current.value,t===8||t===46||y.isIOS()&&t===127?(r=p(),u=r.begin,l=r.end,l-u===0&&(u=t!==46?J(u):l=C(u-1),l=t===46?C(l):l),O(u,l),T(u,l-1),m(e),e.preventDefault()):t===13?(L(e),m(e)):t===27&&(a.current.value=P.current,p(0,g()),m(e),e.preventDefault())}},$=function(e){if(!n.readOnly){var t=e.which||e.keyCode,r=p(),u,l,i,H;if(!(e.ctrlKey||e.altKey||e.metaKey||t<32)){if(t&&t!==13){if(r.end-r.begin!==0&&(O(r.begin,r.end),T(r.begin,r.end-1)),u=C(r.begin-1),u<v.current&&(l=String.fromCharCode(t),s.current[u].test(l))){if(Q(u),f.current[u]=l,k(),i=C(u),y.isAndroid()){var ue=function(){p(i)};setTimeout(ue,0)}else p(i);r.begin<=B.current&&(H=D())}e.preventDefault()}m(e),n.onComplete&&H&&n.onComplete({originalEvent:e,value:F()})}}},O=function(e,t){var r;for(r=e;r<t&&r<v.current;r++)s.current[r]&&(f.current[r]=d(r))},k=function(){a.current&&(a.current.value=f.current.join(""))},g=function(e){_.current=!0;var t=a.current&&a.current.value,r=-1,u,l,i;for(u=0,i=0;u<v.current;u++)if(s.current[u]){for(f.current[u]=d(u);i++<t.length;)if(l=t.charAt(i-1),s.current[u].test(l)){f.current[u]=l,r=u;break}if(i>t.length){O(u+1,v.current);break}}else f.current[u]===t.charAt(i)&&i++,u<R.current&&(r=u);return e?k():r+1<R.current?n.autoClear||f.current.join("")===E.current?(a.current&&a.current.value&&(a.current.value=""),O(0,v.current)):k():(k(),a.current&&(a.current.value=a.current.value.substring(0,r+1))),R.current?u:b.current},ee=function(e){if(!n.readOnly){N.current=!0,clearTimeout(S.current);var t;a.current?P.current=a.current.value:P.current="",t=g()||0,S.current=setTimeout(function(){a.current===document.activeElement&&(k(),t===n.mask.replace("?","").length?p(0,t):p(t),V())},100),n.onFocus&&n.onFocus(e)}},re=function(e){K.current?W(e):z(e)},z=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n.readOnly){if(!t){var r=g(!0);p(r)}m(e),n.onComplete&&D()&&n.onComplete({originalEvent:e,value:F()})}},w=o.useCallback(function(){for(var c=[],e=0;e<f.current.length;e++){var t=f.current[e];s.current[e]&&t!==d(e)&&c.push(t)}return c.join("")},[d]),m=function(e){if(n.onChange){var t=n.unmask?w():e&&e.target.value;n.onChange({originalEvent:e,value:E.current!==t?t:"",stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{name:n.name,id:n.id,value:E.current!==t?t:""}})}},V=function(){a.current&&a.current.value&&a.current.value.length>0?y.addClass(a.current,"p-filled"):y.removeClass(a.current,"p-filled")},j=function(e){var t;return a.current&&(n.value==null?a.current.value="":(a.current.value=n.value,t=g(e),setTimeout(function(){if(a.current)return k(),g(e)},10)),P.current=a.current.value),V(),t},q=o.useCallback(function(){return n.unmask?n.value!==w():E.current!==a.current.value&&a.current.value!==n.value},[n.unmask,n.value,w]),U=function(){if(n.mask){s.current=[],R.current=n.mask.length,v.current=n.mask.length,b.current=null;var e={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};K.current=y.isChrome()&&y.isAndroid();for(var t=n.mask.split(""),r=0;r<t.length;r++){var u=t[r];u==="?"?(v.current--,R.current=r):e[u]?(s.current.push(new RegExp(e[u])),b.current===null&&(b.current=s.current.length-1),r<R.current&&(B.current=s.current.length-1)):s.current.push(null)}f.current=[];for(var l=0;l<t.length;l++){var i=t[l];i!=="?"&&(e[i]?f.current.push(d(l)):f.current.push(i))}E.current=f.current.join("")}};o.useImperativeHandle(h,function(){return{props:n,focus:function(){return y.focus(a.current)},getElement:function(){return a.current}}}),o.useEffect(function(){ce.combinedRefs(a,h)},[a,h]),ie(function(){U(),j()}),Z(function(){U(),p(j(!0)),n.unmask&&m()},[n.mask]),Z(function(){q()&&j()},[q]);var ne=Y.getOtherProps(n),te=oe("p-inputmask",n.className);return o.createElement(se,A({ref:a,autoFocus:n.autoFocus,id:n.id,type:n.type,name:n.name,style:n.style,className:te},ne,{placeholder:n.placeholder,size:n.size,maxLength:n.maxLength,tabIndex:n.tabIndex,disabled:n.disabled,readOnly:n.readOnly,onFocus:ee,onBlur:L,onKeyDown:X,onKeyPress:$,onInput:re,onPaste:function(e){return z(e,!0)},required:n.required,tooltip:n.tooltip,tooltipOptions:n.tooltipOptions,pt:n.pt,unstyled:n.unstyled,__parentMetadata:{parent:G}}))}));fe.displayName="InputMask";export{fe as I};
