import{r as g,u as M,j as t,B as d,y as H,R as w,Y as R,a as x}from"./app-DzIMWlR-.js";import{P as _,M as A}from"./PageContainer-BTM4Fwm9.js";import{T as D}from"./toast.esm-BNqFcbjR.js";import{g as G,d as E,a as F,b as V,m as $}from"./businesses-Co-zBRaF.js";import{O as K,C as I,D as W,a as Y,T as q}from"./checkbox.esm-C33qNPF8.js";import{M as z}from"./PersonalInformation-CbRWY7FS.js";import"./inputmask.esm-D6vT7NK-.js";const ae=({auth:P,csrfToken:p})=>{const[b,o]=g.useState(!0),[u,f]=g.useState([]),[h,y]=g.useState([]),[c,S]=M(["name","email","phone","created_at","actions"],"adminBusinessesWaitApprovalsColumns"),[v,j]=g.useState(null);g.useEffect(()=>{G("unverified",p).then(e=>{e.status?(f(e.businesses),o(!1),j(null)):(j(e.message),o(!1))}).catch(e=>{j(e.message),o(!1)})},[]);const N=(e,a)=>{x({target:e.currentTarget,message:"İşletmeyi silmek istediğinize emin misiniz?",acceptLabel:"Sil",acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){o(!0),E(a,p).then(({status:l,message:s})=>{var r,n;l?(f(u.filter(m=>m.id!==a)),y([]),(r=i.current)==null||r.show({severity:"success",summary:"Başarılı",detail:s})):(n=i.current)==null||n.show({severity:"error",summary:"Hata",detail:s})}).catch(l=>{var s;(s=i.current)==null||s.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})},O=(e,a)=>{x({target:e.currentTarget,message:"İşletme Hesabı Onaylanacaktır. Onaylamak istediğinize emin misiniz?",acceptLabel:"Onayla",acceptClassName:"p-button-success",rejectLabel:"Vazgeç",accept(){o(!0),F(a,p).then(({status:l,message:s})=>{var r,n;l?(f(u.filter(m=>m.id!==a)),y([]),(r=i.current)==null||r.show({severity:"success",summary:"Başarılı",detail:s})):(n=i.current)==null||n.show({severity:"error",summary:"Hata",detail:s})}).catch(l=>{var s;(s=i.current)==null||s.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})},B=(e,a)=>{x({target:e.currentTarget,message:"Seçilen işletmelerin hesapları onaylanacaktır. Onaylamak istediğinize emin misiniz?",acceptLabel:`Onayla (${a.length} İşletme)`,acceptClassName:"p-button-success",rejectLabel:"Vazgeç",accept(){o(!0),V(a,p).then(({status:l,message:s})=>{var r,n;l?(f(u.filter(m=>!a.includes(m.id))),y([]),(r=i.current)==null||r.show({severity:"success",summary:"Başarılı",detail:s})):(n=i.current)==null||n.show({severity:"error",summary:"Hata",detail:s})}).catch(l=>{var s;(s=i.current)==null||s.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})},L=(e,a)=>{x({target:e.currentTarget,message:"Seçilen işletmeler silinecektir. Silmek istediğinize emin misiniz?",acceptLabel:`Sil (${a.length} İşletme)`,acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){o(!0),$(a,p).then(({status:l,message:s})=>{var r,n;l?(f(u.filter(m=>!a.includes(m.id))),y([]),(r=i.current)==null||r.show({severity:"success",summary:"Başarılı",detail:s})):(n=i.current)==null||n.show({severity:"error",summary:"Hata",detail:s})}).catch(l=>{var s;(s=i.current)==null||s.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})};let C=[{selectionMode:"multiple",headerStyle:{width:"3rem"},header:""},{field:"name",header:"Ad Soyad (İşletme Sahibi)",hidden:!c.includes("name"),sortable:!0,filter:!0,filterPlaceholder:"Ad'a Göre"},{field:"email",header:"Email Adresi",hidden:!c.includes("email"),sortable:!0,filter:!0,filterPlaceholder:"Email'e Göre"},{field:"phone",header:"Telefon Numarası",hidden:!c.includes("phone"),sortable:!0,filter:!0,filterPlaceholder:"Telefon Numarası'na Göre"},{field:"created_at",header:"Kayıt Tarihi",hidden:!c.includes("created_at"),sortable:!0,filter:!0,filterPlaceholder:"Kayıt Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:new Date(e.created_at).toLocaleString()})},{field:"updated_at",header:"Güncelleme Tarihi",hidden:!c.includes("updated_at"),sortable:!0,filter:!0,filterPlaceholder:"Güncellenme Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:new Date(e.updated_at).toLocaleString()})},{field:"actions",header:"İşlemler",hidden:!c.includes("actions"),body:e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(d,{size:"small",icon:"pi pi-check-circle",severity:"success",tooltip:"Onayla",tooltipOptions:{position:"top"},onClick:a=>{O(a,e.id)}}),t.jsx(d,{size:"small",icon:"pi pi-pencil",severity:"warning",tooltip:"Düzenle",tooltipOptions:{position:"top"},onClick:a=>{H.visit(route("admin.businesses.edit",{id:e.id}))}}),t.jsx(d,{size:"small",icon:"pi pi-trash",severity:"danger",tooltip:"Sil",tooltipOptions:{position:"top"},onClick:a=>{N(a,e.id)}})]})}];const k=w.useRef(null),T=()=>t.jsx(t.Fragment,{children:t.jsx(q,{start:h.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(d,{size:"small",icon:"pi pi-check-circle",className:"mr-2",tooltip:"Toplu Onay Yapmanızı Sağlar",tooltipOptions:{position:"top"},label:"Onayla ("+h.length+")",severity:"success",onClick:e=>{B(e,h.map(a=>a.id))}}),t.jsx(d,{size:"small",icon:"pi pi-trash",className:"mr-2",tooltip:"Seçilen İşletmeleri Silmenizi Sağlar",tooltipOptions:{position:"top"},label:"Sil ("+h.length+")",severity:"danger",onClick:e=>{L(e,h.map(a=>a.id))}}),t.jsx(d,{size:"small",icon:"pi pi-filter-slash",label:"Seçimi Temizle",severity:"warning",onClick:()=>y([])})]}),end:t.jsx(t.Fragment,{children:t.jsx(d,{icon:"pi pi-bars",onClick:e=>{var a;(a=k.current)==null||a.toggle(e)}})})})}),i=w.useRef(null);return t.jsx(_,{auth:P,csrfToken:p,children:t.jsxs(A,{children:[t.jsx(R,{title:"Onay Bekleyen İşletmeler"}),t.jsx(D,{ref:i}),t.jsxs(K,{ref:k,showCloseIcon:!0,style:{width:"300px"},children:[t.jsx("div",{className:"flex align-items-center justify-content-start mb-3",children:t.jsxs("span",{className:"text-900 text-lg font-bold",children:["Sütunlar (",c.length,")"]})}),t.jsx("div",{className:"flex flex-column justify-content-center gap-2",children:C.map((e,a)=>{if(e.selectionMode==="multiple")return null;let l=e.header,s=e.field;return t.jsxs("div",{className:"flex align-items-center",children:[t.jsx(I,{inputId:`column${a}`,checked:c.includes(s),onChange:r=>{r.checked?S([...c,s]):S(c.filter(n=>n!==s))}}),t.jsx("label",{htmlFor:`column${a}`,className:"ml-2",children:l})]},a)})})]}),t.jsxs("div",{className:"card",children:[t.jsx("span",{className:"text-900 text-xl font-bold mb-4 block",children:"Onay Bekleyen İşletmeler"}),v!==null&&t.jsx(z,{className:"w-full",severity:"error",text:v}),!b&&u.length===0&&t.jsx(z,{className:"w-full",severity:"info",text:"Onay bekleyen işletme bulunamadı."}),t.jsx(W,{hidden:!b&&u.length===0||v!==null,loading:b,value:u,removableSort:!0,paginator:!0,filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",header:T,filters:{name:{value:null,matchMode:"contains"},email:{value:null,matchMode:"contains"},phone:{value:null,matchMode:"contains"},created_at:{value:null,matchMode:"contains"},updated_at:{value:null,matchMode:"contains"}},emptyMessage:"İşletme bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",selectionMode:"checkbox",selection:h,onSelectionChange:e=>y(e.value),children:C.map((e,a)=>t.jsx(Y,{...e},a))})]})]})})};export{ae as default};
