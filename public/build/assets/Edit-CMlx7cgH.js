import{r as m,L as I,R as H,j as e,Y as L,c as s,B as E}from"./app-rTocBdX6.js";import{P as T,M as $}from"./PageContainer-hvsvC_1A.js";import{c as V,a as G,b as c,d as M,u as P,T as Z,I as v}from"./toast.esm-D2zVde1g.js";import{I as U}from"./inputmask.esm-CmU3ILfg.js";import{I as S}from"./inputswitch.esm-BIVsyBSh.js";import{c as Y,u as J}from"./couriers-BFRc8dnL.js";import{B as Q}from"./blockui.esm-Cm44VRYB.js";import"./PersonalInformation-RKrmWs6q.js";import"./message.esm-CpfBJrYs.js";import"./index.esm-CwfZ2Ckd.js";import"./PersonalInformation-C1UDdiEn.js";import"./styleclass.esm-MLMHqxm8.js";const me=({auth:B,csrfToken:g,courierId:w=0})=>{const{setBreadcrumbs:F}=m.useContext(I);m.useEffect(()=>{F(t=>[...t,{labels:["İşletmeler","Düzenle"],to:window.location.href}])},[]);const[l,A]=m.useState({id:"",name:"",email:"",phone:"",password_change:!1,password:"",password_confirmation:"",account_verification:!1,activated_at:""}),u=H.useRef(null),[p,b]=m.useState(!0),[_,D]=m.useState(!1),O=V().shape({id:G().required("Kurye ID bilgisi bulunamadı"),email:c().email("Geçerli bir email adresi giriniz").required("Email adresinizi giriniz"),name:c().required("Ad soyad giriniz").min(3,"Ad Soyad en az 3 karakter olmalıdır"),phone:c().required("Telefon numarası giriniz").matches(/^\(\d{3}\)-\d{3}-\d{4}$/,"Geçerli bir telefon numarası giriniz"),password:c().when("password_change",{is:!0,then:()=>c().required("Şifre giriniz").min(6,"Şifre en az 6 karakter olmalıdır").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,}$/,"Şifreniz en az bir büyük harf, bir küçük harf ve bir rakam içermelidir"),otherwise:()=>c().notRequired()}),password_confirmation:c().when("password_change",{is:!0,then:()=>c().required("Şifreyi tekrar giriniz").oneOf([M("password"),""],"Şifreler uyuşmuyor"),otherwise:()=>c().notRequired()})}),[j,N]=m.useState(!1),k=P({initialValues:l,validationSchema:O,validateOnChange:_,validateOnBlur:_,enableReinitialize:!0,onSubmit:t=>{b(!0);let n={name:t.name,email:t.email,phone:t.phone,password:t.password,password_confirmation:t.password_confirmation,account_verification:t.account_verification?1:0};t.password_change===!0&&(n={...n,password_change:1}),J(w,n,g).then(i=>{var f,x;if(i.status){(f=u.current)==null||f.show({severity:"success",summary:"Başarılı",detail:i.message});let d={id:i.courier.id,name:i.courier.name,email:i.courier.email,phone:i.courier.phone,password_change:!1,password:"",password_confirmation:"",account_verification:i.courier.activated===1,activated_at:i.courier.activated_at===null?!1:new Date(i.courier.activated_at).toLocaleString()};C({values:d})}else{let d={};i!=null&&i.emailExists&&(i==null?void 0:i.emailExists)===!0&&(d={...d,email:"Bu email adresi zaten kullanılmakta"}),i!=null&&i.phoneExists&&(i==null?void 0:i.phoneExists)===!0&&(d={...d,phone:"Bu telefon numarası zaten kullanılmakta"}),y(d),(x=u.current)==null||x.show({severity:"error",summary:"Hata",detail:i.message})}}).catch(()=>{var i;(i=u.current)==null||i.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu lütfen tekrar deneyiniz."})}).finally(()=>{b(!1)})}});let{values:o,setFieldValue:z,resetForm:C,submitCount:r,setErrors:y,handleChange:h,handleSubmit:K,isValid:q,dirty:R}=k,a=k.errors;return m.useEffect(()=>{w!==void 0&&Y(w,g).then(t=>{var f;let{status:n}=t,i=t.courier;if(n){let x={id:i.id,name:i.name,email:i.email,phone:i.phone,password_change:!1,password:"",password_confirmation:"",account_verification:i.activated===1,activated_at:i.activated_at===null?!1:new Date(i.activated_at).toLocaleString()};A(x),C({values:x,errors:{}})}else N(!0),y({id:"Kurye bilgileri alınamadı"}),(f=u.current)==null||f.show({severity:"error",summary:"Hata",detail:"Kurye bilgileri alınamadı"})}).catch(t=>{var n;console.error(t),N(!0),y({id:"Kurye bilgileri alınamadı"}),(n=u.current)==null||n.show({severity:"error",summary:"Hata",detail:"Bir Hata Oluştu Kurye Bilgileri Alınamadı"})}).finally(()=>{b(!1)})},[g,w]),m.useEffect(()=>{r>0&&D(!0)},[r]),e.jsx(T,{auth:B,csrfToken:g,children:e.jsxs($,{children:[e.jsx(L,{title:(l==null?void 0:l.name)!==""?"'"+(l==null?void 0:l.name)+"' Adlı Kuryeyi Düzenle":""}),e.jsx(Z,{ref:u}),e.jsxs("div",{className:"card",children:[e.jsxs("span",{className:"text-900 text-xl font-bold mb-4 block",children:[(l==null?void 0:l.name)!==""?"'"+(l==null?void 0:l.name)+"' Adlı Kuryeyi Düzenle":""," "]}),e.jsxs("div",{className:"grid",children:[e.jsxs("div",{className:"col-12 lg:col-2",children:[e.jsx("div",{className:"text-900 font-medium text-xl mb-3",children:"Kurye Bilgileri"}),e.jsxs("p",{className:"m-0 p-0 text-600 line-height-3 mr-3",children:["Düzeltmek istediğiniz kuryenin bilgilerini aşağıdaki form aracılığıyla düzenleyebilirsiniz.",a&&Object.keys(a).length>0&&e.jsx(e.Fragment,{children:e.jsx("ul",{className:"mt-3",children:Object.keys(a).map((t,n)=>e.jsx("li",{className:"text-red-500 text-sm",children:a[t]},n))})})]})]}),e.jsx("div",{className:"col-12 lg:col-10",children:e.jsx(Q,{blocked:j,template:e.jsx("i",{className:"pi pi-exclamation-circle text-red-400",style:{fontSize:"3rem"}}),containerClassName:s("",{"p-3":j,"p-0":!j}),children:e.jsxs("form",{onSubmit:K,className:"grid formgrid p-fluid",children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"name",className:s("font-medium text-900",{"text-red-500":!!a.name,"text-green-500":!a.name&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!a.name,"pi-check-circle text-green-500 text-sm":!a.name&&r>0})})," Ad Soyad"]}),e.jsx(v,{id:"name",type:"text",autoComplete:"off",name:"name",tooltip:a.name,tooltipOptions:{position:"top"},disabled:p,onChange:h,value:o.name,className:s("w-full",{"p-invalid":!!a.name})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"email",className:s("font-medium text-900",{"text-red-500":!!a.email,"text-green-500":!a.email&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!a.email,"pi-check-circle text-green-500 text-sm":!a.email&&r>0})})," Email Adresi"]}),e.jsx(v,{id:"email",type:"email",autoComplete:"off",name:"email",tooltip:a==null?void 0:a.email,tooltipOptions:{position:"top"},disabled:p,onChange:h,value:o.email,className:s("w-full",{"p-invalid":!!a.email})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"phone",className:s("font-medium text-900",{"text-red-500":!!a.phone,"text-green-500":!a.phone&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!a.phone,"pi-check-circle text-green-500 text-sm":!a.phone&&r>0})})," Telefon Numarası"]}),e.jsx(U,{autoComplete:"off",name:"phone",tooltip:a==null?void 0:a.phone,tooltipOptions:{position:"top",event:"focus",className:"text-red-500"},disabled:p,onChange:h,value:o.phone,mask:"(999)-999-9999",className:s("w-full",{"p-invalid":!!a.phone})})]}),e.jsxs("div",{className:"field mb-4 col-12 p-input-icon-right",children:[e.jsx("label",{htmlFor:"password_change",className:s("font-medium text-900 cursor-pointer select-none"),children:"Şifre Değişikliği"}),e.jsx("br",{}),e.jsx(S,{inputId:"password_change",checked:o.password_change,onChange:t=>z("password_change",t.value??!1)})]}),o.password_change&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"password",className:s("font-medium text-900",{"text-red-500":!!a.password,"text-green-500":!a.password&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!a.password,"pi-check-circle text-green-500 text-sm":!a.password&&r>0})})," Şifre"]}),e.jsx(v,{id:"password",type:"password",autoComplete:"off",name:"password",tooltip:a==null?void 0:a.password,tooltipOptions:{position:"top"},disabled:p,onChange:h,value:o.password,className:s("w-full",{"p-invalid":!!a.password})})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"password_confirmation",className:s("font-medium text-900",{"text-red-500":!!a.password_confirmation,"text-green-500":!a.password_confirmation&&r>0}),children:[e.jsx("i",{className:s("pi",{"pi-times-circle text-red-500 text-sm":!!a.password_confirmation,"pi-check-circle text-green-500 text-sm":!a.password_confirmation&&r>0})})," Şifre Tekrarı"]}),e.jsx(v,{id:"password_confirmation",type:"password",autoComplete:"off",name:"password_confirmation",tooltip:a==null?void 0:a.password_confirmation,tooltipOptions:{position:"top"},disabled:p,onChange:h,value:o.password_confirmation,className:s("w-full",{"p-invalid":!!a.password_confirmation})})]})]}),e.jsxs("div",{className:"field mb-4 col-12 md:col-6 p-input-icon-right",children:[e.jsxs("label",{htmlFor:"account_verification",className:s("font-medium text-900 cursor-pointer select-none"),children:["Hesap Aktifliği ",o.account_verification&&o.activated_at!==!1&&e.jsxs("span",{className:"text-green-500",children:["Akttifleştirme Tarihi : ",o.activated_at]})]}),e.jsx("br",{}),e.jsx(S,{inputId:"account_verification",checked:o.account_verification,onChange:t=>z("account_verification",t.value??!1)})]}),e.jsxs("div",{className:"col-12",children:[e.jsx(E,{label:"Geri",icon:"pi pi-arrow-left",type:"button",severity:"secondary",size:"small",onClick:()=>{window.history.back()},className:"w-auto mt-3 mr-2"}),e.jsx(E,{label:"Kuryeyi Kaydet",disabled:!q||!R,loading:p,size:"small",type:"submit",className:"w-auto mt-3"})]})]})})})]})]})]})})};export{me as default};
