import{r as m,u as J,R as D,j as t,c as Q,B as n,y as U,Y as W,a as j}from"./app-DkDrHmnA.js";import{P as X,M as Z}from"./PageContainer-DJWpDb5I.js";import{T as ee}from"./toast.esm-P3S5sA5A.js";import{e as _,g as te,d as ie,a as le,m as ae,b as re}from"./couriers-COnshcQ-.js";import{D as se,C as ne}from"./column.esm-DvSgIneB.js";import{M,C as oe}from"./message.esm-JjxY_FWb.js";import{C as ce,T as de}from"./checkbox.esm-mdxbDvRm.js";import{O as ue,D as R}from"./ActiveOrder-YaV5mru3.js";import{T as pe}from"./tristatecheckbox.esm-BeSe9iAV.js";import{l as me}from"./index-BuUH8n6D.js";import{g as fe,a as he,b as ge}from"./globalHelper-DnAnK7iK.js";import"./PersonalInformation-ug67P98l.js";import"./inputtext.esm-BfTgRR7K.js";import"./inputmask.esm-BKDd5nSr.js";import"./car-BnQ5UupV.js";import"./PersonalInformation-QXa9O11a.js";import"./styleclass.esm-BjGkao4e.js";import"./sidebar.esm-D8u1Sg6a.js";import"./index.esm-J_mJuZRe.js";import"./inputswitch.esm-jBUhhPbc.js";import"./index.esm-XxtkfCC5.js";const Ee=({auth:E,csrfToken:f,flash:h})=>{const[s,T]=m.useState(null),[H,y]=m.useState(!1),[C,o]=m.useState(!0),[g,b]=m.useState([]),[x,v]=m.useState([]),[u,N]=J(["name","email","phone","created_at","actions"],"adminCouriersApprovedColumns"),[S,k]=m.useState(null),[B,z]=m.useState(!1),[w,P]=m.useState(null),A=D.useRef(null),F=me.useReactToPrint({contentRef:A}),V=e=>{let i=[];return e===null||Object.entries(e).forEach(([l,a])=>{typeof a=="string"&&(l!=="courier"||l!=="status"||l!=="completed"||l!=="approved"||l!=="latitude"||l!=="longitude"||l!=="id"||l!=="courier_id"||l!=="created_at"||l!=="updated_at")&&i.push({label:he(String(l)),value:ge(String(l),String(a))})}),i},L=()=>{o(!0),te("all",f).then(e=>{e.status?(b(e.couriers.map(i=>({...i,activated:i.activated===1}))),o(!1),k(null)):(k(e.message),o(!1))}).catch(e=>{k(e.message),o(!1)}).finally(()=>o(!1))};m.useEffect(()=>{var e;L(),h!=null&&h.message&&((e=r.current)==null||e.show({severity:(h==null?void 0:h.type)??"info",summary:h.title,detail:h.message??""}))},[]);const G=(e,i)=>{j({target:e.currentTarget,message:"Kuryeyi silmek istediğinize emin misiniz?",acceptLabel:"Sil",acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){o(!0),ie(i,f).then(({status:l,message:a})=>{var c,d;l?(b(g.filter(p=>p.id!==i)),v([]),(c=r.current)==null||c.show({severity:"success",summary:"Başarılı",detail:a})):(d=r.current)==null||d.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=r.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})},Y=(e,i)=>{j({target:e.currentTarget,message:"Seçilen kuryeler silinecektir. Silmek istediğinize emin misiniz?",acceptLabel:`Sil (${i.length} Kurye)`,acceptClassName:"p-button-danger",rejectLabel:"Vazgeç",accept(){o(!0),ae(i,f).then(({status:l,message:a})=>{var c,d;l?(b(g.filter(p=>!i.includes(p.id))),v([]),(c=r.current)==null||c.show({severity:"success",summary:"Başarılı",detail:a})):(d=r.current)==null||d.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=r.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})},I=(e,i)=>{j({target:e.currentTarget,message:"Kurye Hesabı Aktifleştirilecektir. Aktifleştirmek istediğinize emin misiniz?",acceptLabel:"Aktfileştir",acceptClassName:"p-button-success",rejectLabel:"Vazgeç",accept(){o(!0),le(i,f).then(({status:l,message:a})=>{var c,d;l?(b(g.map(p=>p.id===i?{...p,activated:!0,activated_at:new Date().toISOString()}:p)),v([]),(c=r.current)==null||c.show({severity:"success",summary:"Başarılı",detail:a})):(d=r.current)==null||d.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=r.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})},$=(e,i)=>{j({target:e.currentTarget,message:"Seçilen kuryelerin hesapları aktifleştirilecektir. Aktifleştirmek istediğinize emin misiniz?",acceptLabel:`Aktifleştir (${i.length} Kurye)`,acceptClassName:"p-button-success",rejectLabel:"Vazgeç",accept(){o(!0),re(i,f).then(({status:l,message:a})=>{var c,d;l?(b(g.map(p=>i.includes(p.id)?{...p,activated:!0,activated_at:new Date().toISOString()}:p)),v([]),(c=r.current)==null||c.show({severity:"success",summary:"Başarılı",detail:a})):(d=r.current)==null||d.show({severity:"error",summary:"Hata",detail:a})}).catch(l=>{var a;(a=r.current)==null||a.show({severity:"error",summary:"Hata",detail:l.message})}).finally(()=>o(!1))}})};let O=[{selectionMode:"multiple",headerStyle:{width:"3rem"},header:""},{field:"name",header:"Adı Soyadı",hidden:!u.includes("name"),sortable:!0,filter:!0,filterPlaceholder:"Ad'a Göre"},{field:"email",header:"Email Adresi",hidden:!u.includes("email"),sortable:!0,filter:!0,filterPlaceholder:"Email'e Göre"},{field:"phone",header:"Telefon Numarası",hidden:!u.includes("phone"),sortable:!0,filter:!0,filterPlaceholder:"Telefon Numarası'na Göre"},{field:"activated",header:"Aktiflik Durumu",hidden:!u.includes("activated"),sortable:!0,filter:!0,dataType:"boolean",filterElement:e=>t.jsx(pe,{value:e.value,onChange:i=>e.filterApplyCallback(i.value)}),body:e=>t.jsx("i",{className:Q("pi",{"pi-check-circle text-green-400":e.activated,"pi-times-circle text-red-400":!e.activated})})},{field:"activated_at",header:"Aktifleştirme Tarihi",hidden:!u.includes("activated_at"),sortable:!0,filter:!0,filterPlaceholder:"Aktifleştirme Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:e.activated_at===null?t.jsx("i",{className:"pi pi-times-circle text-red-400"}):new Date(e.activated_at).toLocaleString()})},{field:"created_at",header:"Kayıt Tarihi",hidden:!u.includes("created_at"),sortable:!0,filter:!0,filterPlaceholder:"Kayıt Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:new Date(e.created_at).toLocaleString()})},{field:"updated_at",header:"Güncelleme Tarihi",hidden:!u.includes("updated_at"),sortable:!0,filter:!0,filterPlaceholder:"Güncellenme Tarihine Göre",filterType:"date",body:e=>t.jsx("span",{children:new Date(e.updated_at).toLocaleString()})},{field:"actions",header:"İşlemler",hidden:!u.includes("actions"),body:e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(n,{icon:"pi pi-print",tooltip:"Kurye Bilgilerini Yazdır",severity:"help",size:"small",tooltipOptions:{position:"top"},onClick:i=>{P(e.details),z(!0)}}),t.jsx(n,{size:"small",icon:"pi pi-file-export",severity:"info",tooltip:"Sipariş Çıktısı Al",tooltipOptions:{position:"top"},onClick:()=>{T(fe()),P(e),y(!0)}}),t.jsx(n,{size:"small",icon:"pi pi-check-circle",severity:"success",tooltip:"Aktifleştir",tooltipOptions:{position:"top"},visible:!e.activated,onClick:i=>{I(i,e.id)}}),t.jsx(n,{size:"small",icon:"pi pi-pencil",severity:"warning",tooltip:"Düzenle",tooltipOptions:{position:"top"},onClick:()=>{U.visit(route("admin.couriers.edit",{id:e.id}))}}),t.jsx(n,{size:"small",icon:"pi pi-trash",severity:"danger",tooltip:"Sil",tooltipOptions:{position:"top"},onClick:i=>{G(i,e.id)}})]})}];const K=D.useRef(null),q=()=>t.jsx(t.Fragment,{children:t.jsx(de,{start:x.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(n,{size:"small",icon:"pi pi-check-circle",className:"mr-2",tooltip:"Toplu Aktifleştirme Yapmanızı Sağlar",tooltipOptions:{position:"top"},visible:x.map(e=>e.activated?null:e.id).filter(e=>e!==null).length>0,label:"Aktifleştir ("+x.map(e=>e.activated?null:e.id).filter(e=>e!==null).length+")",severity:"success",onClick:e=>{$(e,x.map(i=>i.activated?null:i.id).filter(i=>i!==null))}}),t.jsx(n,{size:"small",icon:"pi pi-trash",className:"mr-2",tooltip:"Seçilen Kuryeleri Silmenizi Sağlar",tooltipOptions:{position:"top"},label:"Sil ("+x.length+")",severity:"danger",onClick:e=>{Y(e,x.map(i=>i.id))}}),t.jsx(n,{size:"small",icon:"pi pi-filter-slash",label:"Seçimi Temizle",severity:"warning",onClick:()=>v([])})]}),end:t.jsxs(t.Fragment,{children:[t.jsx(n,{size:"small",icon:"pi pi-sync",severity:"help",className:"mr-2",tooltip:"Verileri Yenile",tooltipOptions:{position:"top"},onClick:()=>{L()}}),t.jsx(n,{icon:"pi pi-bars",onClick:e=>{var i;(i=K.current)==null||i.toggle(e)}})]})})}),r=D.useRef(null);return t.jsx(X,{auth:E,csrfToken:f,children:t.jsxs(Z,{children:[t.jsx(W,{title:"Tüm Kuryeler"}),t.jsx(ee,{ref:r}),t.jsxs(ue,{ref:K,showCloseIcon:!0,style:{width:"300px"},children:[t.jsx("div",{className:"flex align-items-center justify-content-start mb-3",children:t.jsxs("span",{className:"text-900 text-lg font-bold",children:["Sütunlar (",u.length,")"]})}),t.jsx("div",{className:"flex flex-column justify-content-center gap-2",children:O.map((e,i)=>{if(e.selectionMode==="multiple")return null;let l=e.header,a=e.field;return t.jsxs("div",{className:"flex align-items-center",children:[t.jsx(ce,{inputId:`column${i}`,checked:u.includes(a),onChange:c=>{c.checked?N([...u,a]):N(u.filter(d=>d!==a))}}),t.jsx("label",{htmlFor:`column${i}`,className:"ml-2",children:l})]},i)})})]}),t.jsxs("div",{className:"card",children:[t.jsx("span",{className:"text-900 text-xl font-bold mb-4 block",children:"Tüm Kuryeler"}),S!==null&&t.jsx(M,{className:"w-full",severity:"error",text:S}),!C&&g.length===0&&t.jsx(M,{className:"w-full",severity:"info",text:"Kurye bulunamadı."}),t.jsx(se,{hidden:!C&&g.length===0||S!==null,loading:C,value:g,removableSort:!0,paginator:!0,filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",header:q,filters:{name:{value:null,matchMode:"contains"},email:{value:null,matchMode:"contains"},phone:{value:null,matchMode:"contains"},created_at:{value:null,matchMode:"contains"},updated_at:{value:null,matchMode:"contains"},activated:{value:null,matchMode:"equals"}},emptyMessage:"Kurye bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",selectionMode:"checkbox",selection:x,onSelectionChange:e=>v(e.value),children:O.map((e,i)=>t.jsx(ne,{...e},i))})]}),t.jsx(R,{header:"Kurye Bilgilerini Yazdır",draggable:!1,footer:t.jsxs("div",{className:"gap-2",children:[t.jsx(n,{size:"small",icon:"pi pi-times",label:"Kapat",severity:"danger",tooltip:"Kapat",tooltipOptions:{position:"top"},onClick:()=>z(!1)}),t.jsx(n,{size:"small",icon:"pi pi-print",label:"Yazdır",severity:"success",tooltip:"Yazdır",tooltipOptions:{position:"top"},onClick:()=>{F()}})]}),onHide:()=>z(!1),visible:B,style:{width:"50vw"},resizable:!1,className:"mx-3 sm:mx-0 w-full md:w-8 lg:w-6 p-fluid",modal:!0,children:t.jsx("div",{children:t.jsx("dl",{ref:A,className:"tw-max-w-md tw-text-gray-900 tw-divide-y tw-divide-gray-300 tw-print:tw-text-black tw-print:tw-divide-gray-400",children:V(w).map((e,i)=>t.jsxs("div",{className:"tw-flex tw-flex-col tw-pb-3 tw-mb-1 tw-print:tw-pb-2 tw-print:tw-mb-2 tw-border-b tw-border-gray-300",children:[t.jsx("dt",{className:"tw-mb-1 tw-text-gray-600 tw-print:tw-text-gray-800 tw-text-sm",children:e.label}),t.jsx("dd",{className:"tw-font-semibold tw-m-0 tw-text-base tw-print:tw-font-bold",children:e.value})]},i))})})}),t.jsx(R,{header:"Sipariş Raporu İndir",draggable:!1,footer:t.jsxs("div",{className:"gap-2",children:[t.jsx(n,{size:"small",icon:"pi pi-times",label:"Kapat",severity:"danger",tooltip:"Kapat",tooltipOptions:{position:"top"},onClick:()=>y(!1)}),t.jsx(n,{size:"small",icon:"pi pi-file-excel",label:"Excel",severity:"info",tooltip:"Excel Çıktı Al",tooltipOptions:{position:"top"},onClick:()=>{if(s.length>0&&s[0]!==null&&s[1]!==null){let e=new Date(s[0]??new Date).getTime(),i=new Date(s[1]??new Date).getTime();_(w.id,e,i,"xlsx",f,r==null?void 0:r.current,()=>{y(!1)})}}}),t.jsx(n,{size:"small",icon:"pi pi-file-pdf",label:"PDF",severity:"success",tooltip:"PDF Çıktı Al",tooltipOptions:{position:"top"},onClick:()=>{if(s.length>0&&s[0]!==null&&s[1]!==null){let e=new Date(s[0]??new Date).getTime(),i=new Date(s[1]??new Date).getTime();_(w.id,e,i,"pdf",f,r==null?void 0:r.current,()=>{y(!1)})}}})]}),onHide:()=>y(!1),visible:H,style:{width:"50vw"},resizable:!1,className:"mx-3 sm:mx-0 w-full md:w-8 lg:w-6 p-fluid",modal:!0,children:w!==null&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{children:[t.jsx("b",{children:w.name})," Adlı Kuryenin Tarih Bazlı Sipariş Çıktısını Almak İçin Tarih Aralığını Seçiniz"]}),t.jsx("hr",{}),t.jsx(oe,{value:s,inline:!0,onChange:e=>{T(e.value)},selectionMode:"range",readOnlyInput:!0}),t.jsx("hr",{}),t.jsxs("p",{children:["Seçilen Tarihler : ",t.jsxs("b",{children:[s!==null&&new Date(s[0]??new Date).toLocaleDateString()," - ",s!==null&&new Date(s[1]??new Date).toLocaleDateString()]})]})]})})]})})};export{Ee as default};
